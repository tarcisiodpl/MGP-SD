

fails for some set of covariates, yet adjusting for that
set results in a valid functional for the causal effect.

Identifying effects of actions (treatments) on
outcome variables from observational data
and causal assumptions is a fundamental
problem in causal inference. This identification is made difficult by the presence of confounders which can be related to both treatment and outcome variables. Confounders
are often handled, both in theory and in
practice, by adjusting for covariates, in other
words considering outcomes conditioned on
treatment and covariate values, weighed by
probability of observing those covariate values. In this paper, we give a complete graphical criterion for covariate adjustment, which
we term the adjustment criterion, and derive
some interesting corollaries of the completeness of this criterion.

In this paper, we give a complete graphical criterion
for the validity of covariate adjustment as an identification method for causal effects, which we term the
adjustment criterion. We further give some interesting
corollaries of the completeness of our criterion.

Introduction

Estimating causal effects in the presence of confounding variables is an important problem in causal inference. By causal effect here we mean a probability
distribution on some set of outcomes after administering treatment. Confounders are found among those
variables which are related to both treatment and outcome. Pearl [7], [8] developed a system of inference
about such problems using the language of causal diagrams. Though complete rules for identification of
causal effects have been derived using this language [5],
[13], [12], [14] in practice the vast majority of causal effect identification is done either via instrumental variable methods, or by covariate adjustment. Pearl’s
back-door criterion [7] gives graphical conditions for
when covariate adjustment yields valid functionals for
the causal effect. The back-door criterion, however, is
not complete ([8], chapter 11). In other words, there
exist causal diagrams where the back-door criterion

2

Preliminaries

Causal diagrams [7], [8] are directed acyclic graphs
representing probabilistic causal domains. Nodes in
causal diagrams represent variables of interest while
arrows represent direct causal influences. Causal diagrams are associated with structural causal models
(SCMs) defined in [8], chapter 7. SCMs consist of a
set of observed variables V and unobserved or latent
variables {U1 , ..., Uk } = U. Without loss of generality, it is usually assumed that the unobserved variables areQexogenous and drawn from a distribution
P (u) = i P (ui ), and the observed variables are endogenous, whose values are obtained from the values of other variables by means of determining functions. The distribution P (u) over the unobserved variables, together with the functions onto the endogenous variables, define an observed distribution P (v).
Exogenous and endogenous variables together can be
thought of as drawn from a joint distribution P (u, v).
When we mention models or causal models in this paper, we will be referring to structural causal models.
Each causal model induces a causal diagram, as follows. Each variable in the model is represented by
a vertex, and a vertex corresponding to a variable Vi
has arrows incoming from every variable whose value
is used to determine the value of Vi by its determining
function. In such a graph exogenous variables have
no incoming arrows. In this paper we will restrict our
attention to acyclic causal diagrams.
We will also use standard graph-theoretic terminology.

A path is a sequence of edges where each pair of adjacent edges in the sequence share a node, and each
such shared node can only occur once in the path. A
path from a node X to a node Y consists exclusively
of directed arrows pointing away from X is called directed or causal, all other kinds of paths are called
non-causal. An ancestor of X is any node which has
a directed path to X (including X itself). A descendant of X is any node which X has a directed path to
(including X itself). The ancestor set of a node set X
is all ancestors of any node in X. The descendant set
of a node set X is all descendants of any node in X.
We will abbreviate ancestor and descendant sets of X
in G as An(X)G and De(X)G .
One of the advantages of the causal diagram representation is its ability to display conditional independence among variables in terms of a path separation
criterion known as d-separation [6]. Two sets of nodes
X, Y are said to be d-separated by a third set Z if every path from any node X ∈ X to any node Y ∈ Y is
“blocked”. A path is “blocked” if it contains a triple
of consecutive nodes connected in one of the following three ways: Wi → Wj → Wk , Wi ← Wj → Wk ,
and Wi → Wl ← Wk , where Wj ∈ Z, and neither
Wl nor any descendant of Wl is in Z. Paths (or node
sets) that are not d-separated are called d-connected,
active, or open. A path starting with an outgoing arrow is called a front-door path, while a d-connected
path starting with an incoming arrow is called a backdoor path. The relationship between d-separation and
conditional independence is provided by the following
well-known theorem [6].
Theorem 1 (Pearl) Let G be a causal diagram.
Then in any model M with a distribution P (u, v) inducing G, if X is d-separated from Y by Z in G, then
X is independent of Y given Z in P (u, v).
Following [3], we will denote conditional independence
statements like the one in the theorem by (X ⊥⊥ Y|Z).
A graph G which represents independences of P (v) in
M via d-separation is called an I-map of P (v) [6].
If many of the variables in a causal diagram are latent,
it can be inconvenient to consider long path stretches
containing nothing but latent variables. One graphical representation that avoids this is the latent projection [19]. A latent projection of a causal diagram
is a mixed graph containing directed and bidirected
arcs, where there is a vertex for every observable node,
and two observable nodes X, Y are connected by a directed arrow if there is a d-connected path from X to
Y in the original causal diagram containing only arrows pointing away from X and towards Y , and each
node on this path other than X and Y is latent. Similarly, X and Y are connected by a bidirected arrow if

there is a d-connected path from X to Y in the original causal diagram which starts with an arrow pointing to X and ends in an arrow pointing to Y , where
each node on this path other than X and Y is latent.
D-separation generalizes in a straightforward way to
latent projections [9], and latent projections preserve
all d-separation statements of the original causal diagrams. In the remainder of the paper we will assume
all graphs are latent projections.
Consider graphs, shown in Fig. 1 (a), (b) representing
the effect of a drug (X) on an outcome (Y ), in the presence of a chronic exposure (Z), say long term alcohol
abuse. We assume the temporal order of chronic exposure and drug exposure is not known. If the chronic
exposure precedes the drug, as in Fig. 1 (a), it affects both the drug reaction (via liver damage) and
the outcome. If the chronic exposure follows the drug,
as in Fig. 1 (b), it does not affect the outcome, since
the outcome is measured soon after drug exposure
(not giving liver damage from alcohol time to accumulate). These two models disagree on observational
claims which means they can be tested (for instance by
checking if Z is independent of Y given X). However,
assume further that we lack the power to distinguish
these models, yet wish to make inferences about the
causal effect of X on Y .
We can analyze this problem using the do(x) notation,
introduced by Pearl [8] (and equivalent to g(x) notation in [10]). In this notation, do(x) stands for an idealized experiment, or intervention, where the values of
X are set to x, regardless of the normal causal mechanisms which determine the values of X. Pearl formalized the causal effect of X on Y as the distribution of
Y after the do(x) operation, written P (y|do(x)). In
general, P (y|do(x)) is different from the conditional
distribution of Y given X, or P (y|x), since X may be
related to Y both via causal action and via certain
variables which affect both X and Y. In identifying
P (y|do(x)) we are interested only in effects of X on Y
along causal paths.
A classic problem in causal inference is identifying
P (y|do(x)) from observational data, since implementing idealized experiments in practice is difficult. A
well-known way of identifying P (y|do(x)) in situations
where Y and X share common causes is performing
covariate adjustment, in other words
P finding a set of
variables Z such that P (y|do(x)) = z P (y|x, z)P (z).
Pearl developed the well-known back-door criterion
[7], [8], which gave graphical conditions for when the
above adjustment formula yields valid functionals for
P (y|do(x)), where Y, X are variable sets.
Definition 1 (back-door criterion) Let X, Y be
disjoint sets of nodes in a graph G. Then a set Z

z

y

x
(a)

x
(b)

z

x

u

y

z

y
(c)

Figure 1: (a),(b) Causal diagrams
P where the effect
P (y|do(x)) can be identified via z P (y|x, z)P (z). (c)
A causal diagram G where P (y|do(x)) is not identifiable via adjustment for any set.
satisfies the back-door criterion relative to (X, Y) if
• No element in Z is a descendant of X
• Z d-separates all back-door path from X to Y
Theorem 2 (Pearl) If some set Z satisfies the backdoor criterion P
relative to (X, Y) in the graph G, then
P (y|do(x)) = z P (y|x, z)P (z) in every model which
induces G.

For this reason, we concentrate on covariate adjustment in this paper. After introducing relevant terminology in subsequent sections, we will develop a
criterion which will precisely characterize when covariate adjustment for Z yields correct functionals for
P (y|do(x)) in G.

3

Graphs and Counterfactuals

In this section, we will introduce counterfactual distributions, which generalize causal effects, and counterfactual graphs, which display independences in counterfactual distributions.
As mentioned in the previous section, the responses
of the remaining observable variables other than X to
the intervention are represented by an interventional
distribution denoted as P (v\x|do(x)) or Px (v\x). The
response of a single observable variable Y to do(x) is
sometimes denoted with a counterfactual variable Yx .
Similarly, the response of a set Y = {Y 1 , Y 2 , ..., Y k }
to do(x) will be denoted by Yx .

The back-doorPcriterion allows us to conclude that
P (y|do(x)) =
z P (y|x, z)P (z) in Fig. 1 (a). The
back-door criterion, however,
is not complete. In parP
ticular, P (y|do(x)) = z P (y|x, z)P (z) in Fig. 1 (b),
though Z does not satisfy the back-door criterion with
respect to (X, Y ).

The do(x) operation in a graph G can be represented
graphically by removing all arrows pointing to nodes
in X. This is because ordinarily, values of X are determined by direct causal influences stemming from
its parent variables in the graph, and these same influences are ignored by the do(x) operation. We will
denote the resulting graph, which is sometimes called
the mutilated graph, as Gx .

In fact, the process of adjustment itself is not complete in that there are certain graphs where a causal
effect P (y|do(x))
is identifiable, but there is no Z
P
for which
z P (y|x, z)P (z) is a valid functional for
P (y|do(x)). This is true of a graph shown in Fig.
1 (c), where we are interested in P (y|do(x)) and U
is unobserved (which means we cannot adjust for
it).PIn fact, the
for this causal effect
P valid functional
′
′
is
x′ P (y|z, x )P (x ), which is obtained
z P (z|x)
from the front-door criterion [8].

Once we fix the value of every exogenous variable in
the model, the remaining variables become deterministically fixed. This allows us to use the distribution
P over exogenous variables to define joint distributions over counterfactual variables, even if the interventions which determine these variables disagree with
each other. Such a joint distribution is defined as follows:

In general, there are complete algorithms which, given
a graph and a causal effect of interest, produce a functional for the causal effect valid given the causal assumptions embodied by the graph [18], [13],[12]. By
complete, we mean that any time the algorithm fails,
there is no valid functional for the effect of interest
in all models with the given graph, and thus no other
algorithm could produce such a functional. Despite
these results, in practical causal inference problems
identification is generally done via covariate adjustment. This is because in practice it is very difficult
to determine precise causal relationships between variables to produce a graph, while it is much easier to talk
about “coarser” causal notions such as pre-treatment
covariates and confounding.

P (Yx11 = y 1 , ..., Yxkk = y k ) =

X

P (u)

{u|Y 11 (u)=y 1 ∧...∧Y kk (u)=y k }
x
x

where U is the set of exogenous variables in the model.
Independence among counterfactual variables can be
displayed by a special graph, called the counterfactual graph [15], [14], just as independence between
causal variables is displayed by a causal diagram via
d-separation. The construction of the counterfactual
graph is rather intricate, however for the purposes of
this paper it is sufficient to consider a simplified version known as the twin network graph [2], [1].
The twin network graph displays counterfactual independence among two possible worlds, the pre-

x

z

x

y

u

y

ducing if:
• Every three-node path segment of π is a collider
• Every node on the path is ancestral to X or Y

Figure 2: The twin network graph for do(x) in the
graph in Fig. 1 (a).
intervention world which is represented by the original graph G, and the post-intervention world, which is
represented by the graph Gx . In other words, the twin
network graph is an I-map for the joint counterfactual
distribution P (v, vx ), where V is the set of all observable variables, and Vx is the set of all observable
variable after the intervention do(x) was performed.
The observable nodes in these two graphs share the U
variables, to signify common history of these worlds up
to the point divergence due to do(x). We will add an
additional refinement, appearing in [15], where node
copies of all non-descendants of X in G are merged
in the twin network graph (since such nodes are the
same random variable in either intervened or natural
world). Fig. 2 shows the twin network graph for do(x)
in the graph shown in Fig. 1 (a) (note that Z is shared
across both worlds).
We are introducing the mathematics of counterfactuals in this paper because, in the course of proving the
soundness of our criterion for Z serving as a valid adjustment set for treatments X and outcomes Y, we
will show that if the criterion is used in structural
causal models, it will imply that (Yx ⊥⊥ X|Z), in
other words the post intervention outcomes are independent of treatments conditioned on the covariates.
This assumption is sometimes known as conditional
ignorability [11], and is often assumed in practice as
a prelude for using adjustment functionals to identify
causal effects. This implication will show that conditional ignorability is the logically minimal assumption
which permits adjustment in structural causal models, in other words if it’s true, adjustment is valid, and
valid adjustment implies its truth.

4

The Adjustment Criterion

Before we can give a complete graphical criterion, we
need to introduce some helpful terminology.
Definition 2 (collider) A three-node path (X, Y, Z)
from X to Z is called a collider if the edges connecting
X to Y and Y to Z have arrowheads pointing to Y .
Definition 3 (inducing path) A path π from node
set X to node set Y in a causal graph G is called in-

Definition 4 (proper causal path) Let X, Y be
sets of nodes. A causal path from a node in X to a
node in Y is called proper if it does not intersect X
except at the end point.
A complete adjustment criterion would, for any effect
P (y|do(x)), allow any adjustment set Z which opens
all proper causal paths, but blocks “everything else.”
Definition 5 (adjustment criterion) Z satisfies
the adjustment criterion relative to (X, Y) in G if
• No element in Z is a descendant in Gx of any
W 6∈ X which lies on a proper causal path from
X to Y.
• All non-causal paths in G from X to Y are blocked
by Z.
It’s fairly clear from the definition that this criterion
generalizes the back-door criterion. In particular, note
that while all back-door paths are non-causal, not all
non-causal paths are back-door. For example, in the
Fig. 1 (c), there is one causal path from X to Z,
namely X → Z, and one non-causal path from Z to X,
namely Z → Y ← U → X. This path is not back-door
with respect to Z since the edge closest to Z points
away from Z. In Fig. 1 (b), Z satisfies the adjustment
criterion with respect to (X, Y ), yet does not satisfy
the back-door criterion with respect to (X, Y ) (since
Z is a descendant of X).
Lemma 1 If Z satisfies the back-door criterion with
respect to (X, Y) in G, then Z satisfies the adjustment
criterion with respect to (X, Y) in G.
Proof: This follows by above definition and definition
of d-separation.
¤
In the next section, we show that not only does the
adjustment criterion always yield valid functionals for
the causal effect, but whenever it fails on some covariate set in a graph, there is some model which induces
that graph where adjustment by the covariate set will
not yield the correct causal effect expression.

5

Soundness and Completeness

We first prove the completeness direction.

Theorem 3 Assume the adjustment criterion fails to
hold for Z with respect to (X, Y) in G. Then there
exists a model inducing G such that P (y|do(x)) 6=
P
z P (y|x, z)P (z).
Proof: We have two cases to consider. Either Z contains a descendant of a node on a proper causal path
from X to Y, and its closest ancestor on this causal
path is not in X, or no element of Z is a descendant of
a node on a proper causal path from X ∈ X to Y ∈ Y
such that its closest ancestor on this causal path is not
X, but Z opens a non-causal path from X to Y.
For the first case, fix a graph containing only the
proper causal path from X ∈ X to Y ∈ Y with
appropriate segment connecting this path to Z ∈ Z.
See Fig. 3 for an example. Without loss of generality we can assume a single Y in this graph. We get
P (y|do(x)) = P (y|x).
It’s not
P difficult to find a model with this graph
where z P (y|z, x)P (z) to not equal P (y|x). For instance let the node on the path from X to Y that
is the closest to Z be denotedPW . If W = Z,
then P (y|z, x) = P (y|z), so
z P (y|z, x)P (z) =
P (y), which is easy to arrange
to
not equal P (y|x).
P
Otherwise,
P
(y|x)
=
P
(y|w)P
(w|x), while
P
P w
P
(y|x,
z)P
(z)
=
P
(y,
x,
z,
w)/P
(x|z) =
z,w
P
Pz
P
(w|x,
z)P
(z).
P
(y|w)
z
w
P
We can view w P (y|w) as an operator which maps
probability distributions over W onto probability distributions over Y . It is not difficult to arrange P (y|w)
in such a way that this map is one-to-one.
Then all
P
we have to showPis that P (w|x) = z P (w|x, z)P (z|x)
need not equal z P (w|x, z)P (z) in every
P model. But
this is also not hard to show – let
z P (w|x, z) be
one-to-one and make sure P (z|x) is not equal to P (z).
For the second case, assume Z opens a non-causal path
π from X ∈ X to Y ∈ Y. Consider the subgraph G′ of
G containing all nodes in π, along with a path for every
open collider in π, witnessing this collider as ancestral
of Z. Since the first case does not hold, this subgraph
cannot contain nodes on any proper causal path from
X to Y (otherwise, either π contains a proper causal
path as a subpath, or Z contains descendants of nodes
on the proper causal path and the closest ancestor on
the proper causal path is not X). See Fig. 4 for an
example. Thus, in G′ , P (y|do(x)) = P (y). Let the
subset of Z intersecting G′ be denoted Z’.
It is a simple matter to pick the behavior of the
variables on the open path from X to Y such that
′
P (y|x,P
z′ ) is not equal to
P P (y|z ),′ and the map′
pings
z′ P (y|x, z ) and
z′ P (y|z ) do not map a
given
P
(z)
to
the
same
output.
This implies that
P
′
′
P
(y|x,
z
)P
(z
)
is
not
equal
to
P
(y) in the model.
′
z

x

...

w

...

...

z

y

Figure 3: Case 1 of theorem 3.
x

w

m

...

z

k

y

Figure 4: Case 2 of theorem 3.
So far, we have shown that if the adjustment criterion
for Z with respect to (X, Y) is violated in G, we can
find a path from X ∈ X to Y ∈ Y such that there is
a model inducing a subgraph G′ associated with this
path where the causal effect PP(y|do(x)) is not equal
to the adjustment functional z P (y|x, z)P (z). But
to prove the general completeness statement, we need
only find any model where adjustment fails to equal to
the causal effect expression. In particular, we are free
to pick models not faithful [17] to G. In fact, assume
all nodes in G outside of G′ are mutually independent.
Then
for case one, we
P
P have the following identities:
P
(y|x,
z)P
(z)
=
z
z P (y|z, x)P (z)P (y \ {y}), and
P (y|do(x))
=
P
(y|x)P
(y \ P
{y}). For case two, we
P
′
′
have:
P
(y|x,
z)P
(z)
=
z
z′ P (y|x, z )P (z )P (y \
{y}), and P (y|do(x)) = P (y)P (y \ {y}). Our result
then follows for both cases in such a model.
¤
Before showing soundness, we give some definitions
and utility lemmas.
A path is a sequence of edges where each pair of adjacent edges in the sequence share a node, and each
such shared node can only occur once in the path.
Definition 6 (route) A route from X to Y in a
graph G is a sequence of edges in G, where each pair
of adjacent edges share a node, the unshared node of
the first edge is X, and the unshared node of the last
edge is Y .
Note: shared nodes can occur more than once.
A route is d-separated if the same triples are blocked
as in the definition of d-separated paths on p. 2. The
difference between a route and a path is that path sequences cannot contain duplicate nodes while route
sequences can.
Definition 7 (direct route) Let π be a route from
X to Y in G. Label each node occurrence in the route

π by the number of times the node has already occurred
earlier in π (so the first occurrence is labeled 0, the
second is labeled 1, etc.)
A direct route π ∗ is a subsequence obtained from π
inductively as follows:
• First node in π ∗ is the first node in π with the
largest occurrence number.
• If the kth shared node in π ∗ (and mth node in π)
is (Xi , r), and Xi 6= Y , let the k + 1th node in π ∗
be (Xj , n), where Xj is the m+1th node in π, and
n is the largest occurrence number of Xj in π.
Lemma 2 For every route π in G, the direct route π ∗
is a path. Moreover, if π is d-connected, then π ∗ is
d-connected.
Proof: That the direct route is a route follows from the
previous definition – direct routes have node neighbors
only if those nodes were neighbors in the original route,
and those nodes are neighbors in G. The direct route
is a path since the definition only takes nodes in the
original sequence with the largest occurrence numbers.
To show the second part, we must show all three-node
sequences in π ∗ are open. Consider all elements of Z
on the route π. Since π is open, all edges connecting
nodes in π neighboring these elements in Z must point
to them. Since every edge in π ∗ is inherited from π,
this implies that if Z is a part of π ∗ , it must be in the
middle of a collider.
What remains to show is that a collider in π ∗ which
does not have an element of Z as a middle node, must
contain such a node as a descendant. Consider the two
edges e1 , e2 making up such a collider in the original
route π. If these edges are adjacent in π, we are done,
since π is active. Otherwise, let e3 be an edge following
e1 in π, and ee an edge preceding e2 in π. If either e1 , e3
or e4 , e2 form a collider we are also done. Otherwise,
either e3 or e4 must point to an ancestor of Z, if π is
active.
¤
We are now ready to show soundness.
Theorem 4 Assume the adjustment criterion holds
for Z and (X, Y) in G. Then for every model inducing
G, (Yx ⊥⊥ X|Z).
Proof: Assume the adjustment criterion holds in G.
Consider the twin network graph G∗ showing the preintervention world, and the world after do(x). We
want to show that if Z satisfies the adjustment criterion for (X, Y) in G, then X is d-separated from Yx
by Z in the twin network graph. We will show the
contrapositive, namely that an active path from X to
Yx in G∗ implies the criterion is violated.

Fix an active path π from X to Yx in G∗ . Without loss
of generality, assume π intersects X only once at the
endpoint. Since we are conditioning on variables Z in
the pre-intervention world, no descendant of X in the
post-intervention world is conditioned on. Thus, any
active path π from X to Yx that “lands” in the postintervention world must descend, via arrows pointing
to Yx , to Yx .
By above, an active path π from X to Yx in G∗ consists
of three parts, π1 , π2 , π3 , where π1 is just some active
path in the original graph G, π3 is a directed path in
Gx where every node in π3 is a descendant of X, and
π2 is a single edge connecting these paths in G∗ to
form π.
Note that G∗ contains copies of nodes in G, with
one copy corresponding to the variable in the original
world, and another copy corresponding to the variable
in the post-intervention world. Thus, even though π
is a path in G∗ , π may contain counterfactual nodes
(say Wx and W ), which refer to the same node in
G. Let π ′ be a sequence of node/occurrence number
pairs in G obtained from π by the following two steps.
The first step replaces all occurrences of counterfactual variables in π by the nodes in G these variables
were derived from, coupled with appropriate occurrence numbers. The second step replaces all occurrences of a single variable twice in a row in the sequence obtained from step one by a single occurrence
of that node (with occurrence numbers of this node
and all subsequent occurrences appropriately decremented). It’s not difficult to see that π ′ is a route
in G. Let π ∗ be the direct route of π ′ .
Note that the sections of π ′ corresponding to sections
π1 and π3 in π must be active. The remaining section
in π ′ is a node triple containing a middle node whose
copy was pointed to by π2 in π. If this node triple
exists in π, it must also be active in π ′ . Otherwise, it
was obtained from four consecutive nodes in π, with
two middle ones being node copies connected by π2 .
These middle nodes cannot intersect or be ancestral of
Z (or the adjustment criterion is violated). Otherwise,
the triple in π ′ must look like ◦ ← ◦ → ◦, which implies
it’s active. Thus, π ′ is an active route.
By Lemma 2, π ∗ is an active path. If π ∗ is non-causal,
we are done, as this means there is an active non-causal
path connecting Y and X given Z, which contradicts
the adjustment criterion. If π ∗ is causal, we can assume without loss of generality it is also proper causal.
We now have two cases: either π2 is bidirected or directed. Since π ∗ is causal, the first edge in π must be
an arrow leading away from an element in X. But if
π2 is bidirected, then the only way π could be active
in G∗ is if the second node in π is an ancestor of Z.

But by construction of π ∗ , the second node in π is also
the second node in π ∗ (although perhaps with a different occurrence number). But this contradicts the
adjustment criterion.
If the π2 edge is a directed arc, then the nodes it connects are a parent/child pair in G, with the parent copy
(say of node M ) in the G part of G∗ , and the child copy
(say of node N ) in the Gx part of G∗ . Then M cannot
have X ancestors, otherwise it would not be in the G
section of G∗ . If π1 and π3 do not share nodes, then
π ∗ cannot be a proper causal path from X to Y since
otherwise every node in π ∗ , including M , must be a
descendant of X, which is a contradiction.
If π1 and π3 share nodes, then the only way to reach M
from X with an active path that starts with an arrow
pointing away from X is via a collider open by Z. But
this implies the second node in π (and thus the second
node in π ∗ ) is an ancestor of Z, which contradicts the
adjustment criterion.
¤
Corollary 1 Assume the adjustment criterion holds
for P
Z and (X, Y) in G. Then for every model inducing
G, z P (y|x, z)P (z).
Proof: The assumption implies (Yx ⊥⊥ X|Z) in every model inducing G,Pby Theorem 4. By laws of
probability, P (Yx ) =
z P (Yx |z)P (z). The axiom
of consistency (called composition in [8], chapter 7)
then implies the conclusion.
¤

6

Corollaries

We now derive some interesting corollaries of the completeness of the adjustment criterion. First, we show
the logical minimality of the conditional ignorability
assumption for covariate adjustment.
P
Corollary 2 P (y|do(x)) =
z P (y|x, z)P (z) in every model inducing G, if and only if (Yx ⊥⊥ X|Z)
holds in every model inducing G,
Proof: If (Yx ⊥⊥ X|Z) holds in every model, the adjustment formula is valid by proof of Corollary 1. If
the adjustment formula is valid for every model inducing G, then the adjustment criterion holds in G
by Theorem 3, and the adjustment formula holds for
every model inducing G by Corollary 1.
¤
This corollary is useful in practical causal inference situations where we are unwilling to commit to a particular causal diagram due to lack of domain knowledge,
yet feel confident in making limited counterfactual independence assumptions. This corollary states that if
we want to identify effects via covariate adjustment in
such situations, we might as well assume conditional

ignorability, since any other assumption we may use
that permits adjustment will imply it.
Next, we consider the problem of what adjustment sets
are sufficient for an unbiased estimate of causal effect,
given that we know that a valid adjustment set exists.
We give some utility lemmas first.
Lemma 3 A node set X cannot be d-separated from a
node set Y in G if and only if there exists an inducing
path from X to Y in G.
Proof: See proof of Theorem 10 in [16].

¤

Lemma 4 If X and Y are not connected by an inducing path in G then A = An(X ∪ Y) \ (X ∪ Y) is a set
sufficient for d-separating X and Y.
Proof: Any path from X to Y which involves any
nodes not in A must contain a collider and so isn’t
d-connecting. Consider a path from X to Y consisting entirely of nodes in A (we can assume the path
only intersects X and Y at the endpoints). Since we
condition on A, the d-connecting path must contain
only colliders, but this implies there is a path consisting entirely of colliders all of which are ancestral of
X or Y. This contradicts the absence of an inducing
path.
¤
Lemma 5 Let G be a graph, P (y|do(x)) a causal effect. Let M be the set of nodes on the proper causal
paths from X to Y. Let G∗ be the latent projection
obtained from G by marginalizing out M.
Then Z satisfies the adjustment criterion with respect
to (X, Y) in G if and only if Z also satisfies the adjustment criterion with respect to (X, Y) in G∗ .
Proof: Note that Z cannot intersect M or the adjustment criterion is violated. Since marginalization does
not affect d-separation statements, the second part
of the criterion is preserved. Similarly, marginalization does not create new ancestor/descendant relations
that were not present before marginalization. Thus the
first part of the criterion is preserved as well.
¤
The following result suggests that the back-door criterion, despite being incomplete, does capture the intuition behind valid adjustment in some sense, since
whenever a valid adjustment set exists for a causal effect, the subset of this adjustment set which forms the
non-descendants of treatment variables is also a valid
adjustment set.
Theorem 5 Fix
P sets X, Y in G such that
P (y|do(x)) =
z P (y|x, z)P (z) for some set Z in
every causal model inducing G. Let Z∗ = Z \ De(X).
Then Z∗ satisfies the back-door criterion with respect
to (X, Y).

Proof: Consider some d-connected path π from X to
Y, given Z∗ . If π starts with an arrow pointing away
from X then, since Z∗ contains no descendants of X, π
is either proper causal to Y, or non-causal and blocked.
If π starts with an arrow pointing towards X, it is
a back-door path. Since Z∗ contains no descendants
of X, and Z∗ is the only set we are conditioning on,
once π reaches a node W which is a descendant of X,
in order for it to stay active, it must descend along
directed arrows away from W to Y. But no element
of Z \ Z∗ can block the portion of π from W to Y
because that portion of the path is on a proper causal
path from X to Y (since W is a descendant of X).
Thus π must have been active conditioned on Z. But
by assumption Z satisfies the adjustment criterion for
(X, Y), and we have a contradiction.
¤
Theorem 6 Let G be a graph, and P (y|do(x)) a
causal effect. Assume
P a set of nodes Z exists such
that P (y|do(x)) =
z P (y|x, z)P (z) in every model
inducing G. Let M be the set of nodes which lie on
some proper causal
path from X to Y in G. Then
P
P (y|do(x)) = a P (y|x, a)P (a) in every model inducing G, where A = An(X ∪ Y) \ (X ∪ Y ∪ M).

variate set exists, and it is known which covariates are
ancestral of treatments and outcomes, while the exact
causal relationships between covariates themselves are
not known.

7

A Non-counterfactual Soundness
Proof

In the previous section, we assumed structural causal
models, which imply counterfactual quantities, and
we heavily used these quantities in our proofs. This
allowed us to derive logical minimality of the conditional ignorability assumption for covariate adjustment (Corollary 2). Nevertheless, the use of counterfactuals has come under some criticism in the literature [4], due to their untestability. There exist alternative formulations of causal models [8], [17], [4] which
either do not make use of counterfactuals at all. It
is therefore of interest to examine whether our results
are applicable to such models without making use of
counterfactuals. This should be possible since soundness and completeness of the adjustment criterion are
facts about interventional and observational distributions, not specifically about counterfactuals.
In this section, we give such an alternative proof.

Proof: By Theorem 3, Z satisfies the adjustment criterion with respect to (X, Y) in G. Let G∗ be the graph
obtained from G by marginalizing out M. By Lemma
5, Z still satisfies the adjustment criterion with respect
to (X, Y) in G∗ . By Theorem 5, Z∗ = Z \ De(X) satisfies the back-door criterion with respect to (X, Y).
Let G∗x be the graph obtained from G∗ by cutting all
outgoing directed arrows from X. By construction, Z
d-separates X and Y in G∗x . This implies by Lemma
3 that X and Y have no inducing path in G∗x . This,
in turn, implies An(X ∪ Y) \ (X ∪ Y) must also dseparate X from Y in G∗x , by Lemma 4. But this set
is precisely equal to A, and by construction of G∗x , it’s
clear A satisfies the back-door criterion with respect
to (X, Y) in G∗ . Finally, Lemmas 1 and 5 tell us
A satisfies the adjustment criterion with respect to
(X, Y) in G. This proves our result.
¤
Theorem 6 says that if we know that a valid adjustment set exists, we are free to adjust for all ancestors
of treatment and outcome, as long as those ancestors
do not occupy proper causal paths we are interested
in. Adjusting for all observable causal ancestors A can
be statistically desirable when constructing estimators
for causal effects P (y|do(x)), since such a set often includes many independent causes of outcome nodes Y,
and including such nodes in the adjustment set can
improve the efficiency of the estimator. Furthermore,
Theorem 6 can be useful in practical causal inference
problems, where it is often assumed that a valid co-

Definition 8 (magnification) Let G be a causal diagram, let E = {e1 , ..., ek } be a set of edges in G. Let
Ge be a directed acyclic graph constructed as follows.
Ge contains every observable node in G, a new observable node We for every bidirected arc e, and possibly a
new observable node Ci for every directed arc ei ∈ E.
Moreover, in Ge , if an edge is not in E, it exists in
Ge . For every bidirected arc e in G connecting X and
Y , there is a directed edge in Ge from We to both X
and Y , and for every ei ∈ E, connecting X and Y in
G, there is a directed arc in Ge from X to Ci and from
Ci to Y .
Then Ge is the magnification of G with respect to E.
A magnification of a graph is a new graph where we
“unmarginalize” all unobserved variables, and moreover introduce a new mediator for every previously
direct causal arrow from X to Y in E. We call this
graph a magnification because by using this new graph
we are increasing the granularity at which we are looking at our causal model represented by G.
Theorem 7 Let G be a causal diagram, and
P (y|do(x)) a causal effect of interest, and Z a set partitioned into non-descendants of X (Znd ), and descendants of X (Zd ). Let E be the set of all directed edges
pointing away from Y. Let Ge be the magnification
of G with respect to E. Assume there exists a set of
nodes L such that

(a) L∪Znd satisfy the back-door criterion with respect
to (X, Y)
(b) (X ⊥⊥ L|Z)
(c) (Y ⊥⊥ Zd |X, Znd , L)
where statements using the ⊥⊥ symbol in (b) and (c)
are to be interpreted as d-separation statements in Ge .
P
Then P (y|do(x)) =
z P (y|x, z)P (z) in any causal
model M inducing G.
Proof: Fix some model Me which induces Ge which
recovers the marginal P (v) of M when marginalizing over all newly introduced nodes in Ge over
G.
In this model, we have: P (y|do(x)) =
P
Pl,znd P (y|x, l, znd )P (l, znd ), by (a). P (y|do(x)) =
P (y|do(x)) =
Pl,z P (y|x, l, z)P (l, z), by (c). Finally,
P
P
(y|x,
l,
z)P
(l|z,
x)P
(z)
=
P
(y|x,
z)P (z), by
l,z
z
(b). Since adjustment holds in Me , and only makes
use of variables in M , adjustment also holds in M . ¤
What we will show next is the adjustment criterion in
G implies we can always find such an L in Ge . This
means that if we cannot find such an L, the adjustment
criterion fails in G, and it’s completeness (the proof
of which did not use counterfactuals) will imply the
completeness of this alternative criterion. We prove
the implication without using counterfactuals.
Theorem 8 Assume the adjustment criterion holds
for Z with respect to (X, Y) in G. Then we can find
L satisfying the properties in Theorem 7 in Ge .
Proof: Let L be the intersection of the following three
sets: ancestors of Z in Ge , non-descendants of X in Ge ,
and nodes d-connected to Y given Z in the graph Ge \
X where X and all edges pointing to X are removed.
We will show this set satisfies (a), (b) and (c).
(a) implies that L ∪ Znd consists of non-descendants
of X only. This is true by definition for both sets. (a)
also implies that L ∪ Znd block all back-door paths
from X to Y. Assume this isn’t true, and fix an open
back-door path from X to Y given L, Znd . We know
from Theorem 5 that Znd is back-door for (X,Y). That
means Znd by itself blocks this path, and L is what
opens it. So the only way nodes in L are involved in the
back-door path are by being descendants of colliders on
this path. L is an ancestor of either Z not through X,
or of X. In the former case, Z opens the collider on the
path. In the latter case, we restart the argument with
a back-door path from X ∈ X between L and Z. If
all colliders are thus open, we get a contradiction since
we assumed all non-causal paths, and in particular all
back-door paths from X to Y are blocked by Z.

Assume (b) isn’t true. Then there is an open path
from X to L that is either causal, or non-causal. Since
L is not a descendant of X, this path is not causal.
Otherwise, there is a non-causal path from X to L ∈ L
(given Z), and an open path from L ∈ L to Y (given
Z). Adjoining these two d-connected paths creates a
d-connected route π from X to Y. The direct route
π ∗ of π is then a d-connected path given Z from X to
Y by Lemma 2. Moreover, since the path from L to
Y is in G \ X, the direct route is non-causal, and we
have a contradiction.
Assume (c) isn’t true. Then there is an open path
from Zd to Y that is either causal or non-causal. If
it’s causal, then the adjustment criterion is violated,
since Zd will block a proper causal path from X to Y.
If the path π from Zd to Y is non-causal, then it’s most
general form is: Zd o → Z1 ← ... → Zk ← oY . Here
circles at the edge ends of the first and last edge of the
path mean that end of edge can be either an arrow or
a tail, and elements Z1 , ...Zk are in X ∪ Znd ∪ L.
Consider the Zi ∈ X closest (on π) to Y among all
Zi which belong to X. Then we restart our argument
considering a back-door path from this Zi to Y . Thus
we can assume Z1 , ..., Zk does not intersect X. Similarly, if Zi ∈ L, Zi must be ancestral of Z. If it’s
only ancestral via an element in X, we consider the Zi
closest to Y along π with this property, and conclude
there is a non-causal path from that X to Y that’s
open given Z. This contradicts the adjustment criterion we assumed. If Zi is ancestral of Z not via X,
then if this Z is in Zd , we repeat the argument with
this Zd being the new endpoint of a non-causal path
to Y . Otherwise, Z is in Znd . Thus, without loss of
generality assume all Z1 , ..., Zk are in Znd .
We have two cases, the path ends in → Y , or ← Y . In
the former case, if the highest point on the Zk ← ... →
Y segment is a descendant of X, then Zk cannot be in
Znd as was our assumption. If the highest point is not
a descendant of X, it is in L by definition (since it is
d-connected to Y given Z in G\X, is an ancestor of Z,
and not a descendant of X), and so is conditioned on
and blocks this path. If the path ends in ← Y , then if
this Y is a descendant of X, the adjustment criterion
is violated since this Y must be an ancestor of Z. If Y
is not a descendant of X, then it’s mediator variable
we added to Ge which connects Y to its second node
on the path cannot be a descendant of X either, and
so is in L and blocks the path.
¤

8

Discussion

We have given a complete criterion for covariate adjustment in structural causal models. This criterion
generalizes the well-known back-door criterion [7], to

certain cases where its permissible to adjust for descendants of treatment variables. Our criterion implies
that whenever we adjust using a (valid) covariate set
which includes descendants of the treatment variable,
it is possible to remove these descendants from the covariate set, without affecting validity of adjustment.
Additionally, we show that the existence of a valid
adjustment set of any kind implies adjusting for all
ancestors of treatment and outcome that do not lie on
causal paths of interest is sufficient to give a valid estimate of the causal effect. We give both a counterfactual proof of our result, which implies the logical minimality of the conditional ignorability assumption for
covariate adjustment, and a non-counterfactual proof
which holds in models which remain agnostic about
counterfactual statements.
We believe characterizing covariate adjustment is important because, despite the fact that more sophisticated identification methods exist [18], [12], the vast
majority of causal effect identification in practice is
done via covariate adjustment.
Our result allows the use of covariate adjustment even
if the model is partially unspecified or misspecified,
in other words if the direction of some arrows in the
causal diagram is unknown or incorrect. Going back
to our example in Fig. 1, our results allow us to use
the adjustment formula safely, even if we are not sure
whether the graph in Fig. 1 (a) or the graph in Fig. 1
(b) is the correct model, and lack the statistical power
to distinguish these cases.
Finally, since our result can be used to list all possible
valid covariate sets for a given causal effect, it paves
the way for considering which set yields the most statistically desirable estimator of a causal effect, for instance in terms of efficiency, or mean squared error.

