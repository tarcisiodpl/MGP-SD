

In this paper some initial work towards a new
approach to qualitative reasoning under un­
certainty is presented. This method is not
only applicable to qualitative probabilistic
reasoning, as is the case with other methods,
but also allows the qualitative propagation
within networks of values based upon possi­
bility theory and Dempster-Shafer evidence
theory. The method is applied to two simple
networks from which a large class of directed
graphs may be constructed. The results of
this analysis are used to compare the quali­
tative behaviour of the three major quantita­
tive uncertainty handling formalisms, and to
demonstrate that the qualitative integration
of the formalisms is possible under certain as­
sumptions.
1

INTRODUCTION

In the past few years, the use of reasoning about qual­
itative changes in probability to deal with uncertainty
has become widely accepted, being applied to domains
such as planning [Wellman 1990b] and generating plau­
sible explanations [Henrion and Druzdzel 1990]. Such
a qualitative approach has certain advantages over
quantitative methods, not least among which is the
ability to model domains in which the relation between
variables is uncertain as a result of incomplete knowl­
edge, and domains in which numerical representations
are inappropriate.
The existence of the latter, as Wellman [1990a] points
out, is often due to the precision of numerical methods
which can, in certain circumstances, lead to knowledge
bases being applicable only in very narrow areas be­
cause of the interaction between values at a fine level
of detail. Since they view the world at a higher level of
abstraction, qualitative methods are immune to such
*Current address: Advanced Computation Laboratory,
Imperial Cancer Research Fund, P. 0. Box 123, Lincoln's
Inn Fields, London, WC2A 3PX, UK

problems; the small complications such interactions
cause simply have no effect at the coarse level of detail
with which qualitative methods are concerned.
The focus of the qualitative approach of Wellman and
Henrion and Druzdzel is assessing the impact of evi­
dence. That is assessing how the change in probabil­
ity of one event due to some piece of evidence affects
the probability of other events. For instance, taking
a patient's temperature and finding that it is 38C is
evidence that increases the probability that she has a
fever, which in turn increases the probability that she
has measles.
Now, when using the qualitative method we reason
with a restricted set of values. Instead of using the full
range of real numbers we are only interested in whether
values are positive [+], negative [-], zero [0], or any
of the three [?]. Thus we can determine that since
the probability of fever increases, the change in prob­
ability is [+], and use this to decide that the change
in probability of measles is also [+]. This is clearly
weaker information than that obtained by traditional
methods but may still be useful [Wellman 1990a], in
particular since qualitative results may be obtained in
situations where no numerical information may be de­
duced.
2

A NEW QUALITATIVE
APPROACH

This paper presents a new approach to reasoning about
qualitative changes. This work is drawn from the first
author's thesis [Parsons 1993] in which may be found
a number of extensions to the work described here.
The motivation behind this work was to integrate dif­
ferent approaches to reasoning under uncertainty, in
particular probability, possibility [Zadeh 1978] [Dubois
and Prade 1988a], and evidence [Shafer 1976] [Smets
1988) theories. Thus, our qualitative approach differs
from that described above in that it is concerned with
changes in possibility values [Parsons 1992a] and belief
values [Parsons 1992b) as well as probability values. As
a result we need a general way of referring to values
that may be probabilities, possibilities or beliefs.

436

Parsons and Mamdani

Defini ti on 2.1: The certainty value of a variable X
taking value x, val(x), is either the probability of X,
p(x), the possibility of X, II(x), or the belief in X,
bel(x).

We set our work in the framework of singly connected
networks in which the nodes represent variables of in­
terest, and the edges represent explicit dependencies
between the variables. When the edges, of such graphs
are quantified with conditional probability values they
are similar to those studied by Pearl [1988], when pos­
sibility values are used the graphs are similar to those
of Fonck and Straszecka [1991J and when belief values
are used the graphs are those studied by Smets [ 1991J .
Each node in a graph represents a binary valued vari­
able. The probability values associated with a vari­
able X which has possible values x and •X are p(x)
and p( •x), and the possibility values associated with
X are II(x) and II(•x). Belief values may be assigned
to any subset of the values of X, so it is possible to
have up to three beliefs associated with X; bel({x}),
bel({•x}) and bel({x,•x}). For simplicity these will
be written as bel(x), bel(•x) and bel(x •x). This
rather restrictive framework is loosened in [Parsons
1993J where non-binary values and multiply connected
are considered.

U

Wellman [1990a, 1990bJ and Henrion and Druzdzel
[1990J base their work upon the premise that a suitable
interpretation of "a positively influences c" is that:
p(c a) :2: p(c •a)
(1)
This seems reasonable, but it is a premise; there are
other ways of encoding the information that seem
equally intuitively acceptable, for instance p(c I a) >
p(c) and p(c I a) >p(•c a) [Dubois and Prade 1991J.
Since our aim was to provide a method that was suit­
able for integrating formalisms we wanted to start from
first principles thus minimising the number of neces­
sary assumptions. As a result, a different approach
was adopted as described below.

I

I

a change in, say, val(a) affects val(c) to propagate
the effect of the evidence. We define the following
relationships that describe how the value of a variable
X changes when the value of a variable Y is altered
by new evidence:
Defini ti on 2.2: The certainty value of a variable X
taking value x is said to follow the certainty value
of variable Y taking value y, val(x) follows val(y),
if val(x) increases when val(y) increases, and val(x)
decreases when val(y) decreases.
Defini ti on 2.3: The certainty value of a variable X
taking value x is said to vary inversely with the cer­
tainty value of variable Y taking value y, val(x) varies
inversely with val(y), if val(x) decreases when val(y)
increases, and val(x) increases when val(y) decreases.
Defini ti on 2.4: The certainty value of a variable X
taking value x is said to be independent of the cer­
tainty value of variable Y taking value y, val(x) is
independent of val(y), if val(x) does not change as
val(y) increases and decreases.

The way in which the variation of val(x) with val(y)
is determined is by establishing the qualitative value
of the derivative 8val(x)\8val(y) that relates them. If
the derivative is known, it is a simple matter to cal­
culate the change in val(x) from the change in val(y).
Thus to determine the change at C in Figure 1 we
have:
8val(c)
6-val(c) = 6-val(a) 0
(2a)
Bval(a)

[

EB

I

Given a link joining nodes A and C as in Figure 1,
we are interested in the way in which a change in the
value of a, say, expressed in a particular formalism, in­
fluences the value of c. Note that the arrow between A
and C does not necessarily indicate a causal relation­
ship between them, rather it suggests that propagation
of qualitative changes will be from A to C.

0---·0
A

c

Figure 1: A simple network
We can then model the impact of evidence that affects
the value of A in terms of the change in certainty value
of a and •a, relative to their value before the evidence
was known, and use knowledge about the way that

6-val(•c)

=

6-val(•a) 0

]

[ 8val(c) ]
Bval(•a)

[ a;va�i0;)]
[ 8val( •c) ]
6-val(•a)

6-val(a) 0
EB

0

(2b)

Bval(•a)

where [ xJ is [+J if x is positive, [OJ if x is zero and [-J if
x is negative, and EB and 0 denote qualitative addition
and multiplication respectively:
EB

[+J
[OJ
[-J
[?J
0

[+J
[OJ
[-J
(?J

[+J
[+J
[+J
[?J
[?J

[OJ
[+J
[OJ
[-J
[?J

[-J
[?J
[-J
[-J
[?J

[?J
[?J
[?J
[?J
[?J

[+J
[+J
[OJ
[-J
(?J

[OJ
[OJ
[OJ
[OJ
[OJ

[-J
[-J
[OJ
[+J
[?J

[?J
[?J
[OJ
[?J
(?J

We can express this as a matrix calculation (after Far-

On reasoning in networks with qualitative uncertainty

reny and Prade [1989]) :
(3)

0

[ D..D..vval(-.a)
al(a) ]

Clearly val(c) follows val(a) when 8val(c)\8val(a) =
[+], val(c) varies inversely with val(a) when
8val(c)\8val(a) = [-] and is independent of val(a)
when 8val(c)\8val(a)= [0].
3

QUALITATIVE CHANGES IN
SIMPLE NETWORKS

Applying probability theory to the example of Figure
1, so that val(x) becomes p(x) in (2) and (3), and re­
ferring to the directed link joining A and C as A --+ C,
we have the following simple result which agrees with
the assumption (1) made by Wellman as a basis for
his qualitative probabilistic networks when conditional
values are taken as constant, as they are throughout
this work:
Theorem 3.1: The relation between p(x) and p(y)
for the link A --+ C is such that p(x) follows p(y) iff
p(x I y) > p(x I -.y), p(x) varies inversely with p(y)
iff p(x I y) < p(x I -.y) and p(x) is independent of
p(y) iff p(x I y) = p(x I -.y) for all for all x E {c, -.c},
yE{a,-.a}.
Proof: Probability theory tells us that p(c) = p(a)
p(c I a) + p(-.a)p(c I -.a) and p(a) = 1- p(-.a) so
that p(c) = p(a)[ p(c I a) - p(c I -.a)] + p(cl-.a) and
[8val(c)\8val(a)J = [ p(cla)- p(cl-.a)J. Similar rea­
soning about the way that p(c) varies with p(-.a) and
p(-.c) varies with p(a) and p(-.a) gives the result.D

By convention [ Pearl1988J two nodes A and C are not
connected in a probabilistic network if p(a I c)= p(a I
-.c) . In addition, since p(a) and p(-.a) are related by
p(a) = 1 - p(-.a), we can say that if p(c) follows p(a),
then p(-.c) varies inversely with p(a) and follows p(-.a).
The assumption that conditional probabilities are con­
stant does not seem to cause problems when propagat­
ing changes in singly connected networks as discussed
here. However, the assumption does become problem­
atic when handling multiply connected networks [ Par­
sons 1993].
Applying possibility theory to the network of Figure
1, and writing II(x) for val(x) in (2) and (3), we can
establish a relationship between II(a) and II(c). Un­
fortunately, unlike the analogous expression for prob­
ability theory, this involves the non-conditional value
II(a). This complicates the situation since the exact
form of the qualitative relationship between II(a) and
II(c) depends upon whether II(a) is increasing or de­
creasing. '�'e have:

437

Theorem 3.2: The relation between II(x) and II(y),
for all x E {c,-.c}, y E {a,-.a}, for the link A --+ C is
such that II(x) follows II(y) if min(II(x I y),II(y)) >
min(II(x I -.y),II(-.y)) and II(y) < II(x I y). If
min(II(x I y), II(y)) ::; min(II(x I -.y),II(-.y)) and
II(y) < II(x I y) then II(x) may follow II(y) up if
II(y) is increasing, and if min(II(x I y), II(y)) >min
(II(x I -.y), II(-.y)) and II(y) � IT(x I y) then II(x)
may follow II(y) down if II(y) is decreasing. Other­
wise II(x) is independent of II(y).

Possibility theory gives II(c)= sup [min(II(c I
a),II(a)),min('�r(c I -.a),II(-.a))] . This may not be
differentiated, but consider how a small change in II(a)
will affect II(c). If II(a) is the value that determines
II(c), any change in II(a) will be reflected in II(c). This
must happen when min(II(c I a),II(a)) > min(II(c I
-.a),II(-.a)) and II(a) < II(c I a). If II(a) is increas­
ing and the second condition does not hold, it may
become true at some point, and so the increase may
be reflected in II(c). Similar reasoning may be applied
when II(a) is decreasing and the first condition is ini­
tially false. Thus we can write down the conditions
relating II(c) and II(a), while those relating II(c) and
II(-.a) as well as those relating II(-.c) and II(a) and
II(-.a) may be obtained the same way. D
Proof:

To formalise this we can say that [8val(c)\8val(a)] =
[iJ if ii(x) may follow II(y) up and [8val(c)\8val(a)J=
[!J if ii(x) may follow II(y) down while extending 0 to
give:
0

[+J
[OJ
[-J
[?J

[+J
[+J
[OJ
[-J
[?J

[OJ
(OJ
[OJ
[OJ
[OJ

[-J
[-J
[OJ
[+J
[?]

[?J
[?J
[OJ
[?J
[?J

[i J
[+,OJ
[OJ
[OJ
[+,0]

[!]
[OJ
[OJ
[-,OJ
[-,0]

where [+,OJ indicates a value that is either zero or
positive. Normalisation, the possibilistic equivalent of
p(a)= 1-p(-.a), ensures that max(II(a), II(-.a))= 1.
Thus at least one of II(a) and II(-.a) is 1, and at most
one of II(a) and II(-.a) may change, so II(x) changes
when either II(y) or II(-.y) changes.
Writing bel(x) for val(x) in (2) and (3), and using
Dempster's rule of combination [ Shafer 1976 J to com­
bine beliefs in the network of Figure 1, we have:
Theorem 3.3: The relation between bel(x) and bel(y)
for the link A --+ C is such that bel(x) follows bel(y)
iff bel(x I y) > bel(x I y U -.y), bel(x) varies inversely
with bel(y) iff bel(x I y) < bel(x I y U -.y) and bel(x)
is independent of bel(y) iff bel(x I y) = bel(x I y u-.y)
for all x E {c,c}, y E {a, a}.
Proof: By Dempster's rule bel(c)= La�{a,-,a} m(a)
bel(c I a). Now, from Shafer [1976 J m(a) = bel(a),
m(-.a)= bel(-.a) and m(au-.a)= 1-bel(a)- bel(-.a).
Thus 8bel(c)\8bel(a)= bel(c I a)-bel(c I aU-.a). Sim-

438

Parsons and Mamdani

bel(c)andvariesbel(with
bel(•a) bel(-.c)
bel(a)
•a)
Note that bel(c) is the belief in hypothesis c given all
the available evidence, while bel(c I aU •a) is the belief
induced on cby the marginalisation on {c -.c} of the
joint belief on the space {c U •c} {a U •a}. Thus
bel(c) follows bel(a) if cis more likely to occur given a
than given the whole frame. Other results are possible
when alternative rules of combination, such as Smets'
disjunctive rule [ Smets 1991], are used.
ilar reasoning about the way that
and
varies with
gives the result. 0

U

x

The results presented in this section allow the propa­
gation of changes in value from A to C given condi­
tionals of the form
It is possible to derive
similar results for propagation from C to A [Parsons
which say, for instance, that if
follows
then
follows

val(c Ia).
p(c).

1993]p(a)

p(c)

p(a),

�ll(•a)=[0,-]
a)=[
+0]] Then
II(a) f; 1 If �II(
Then �II(•a) =(0]
�II(
a)
=
[
If �II(a) =[-] Then �II(•a)=(0]
For any II(a), either [8II(c)\8II(a)J
[0] or
[8II(c)\8II(a)]=[+]while:
Then �II(•c)=[?]
�II(c)=
([0-]] Then
II(c)=1 IfIf �II(c)
=
�II(•c)=[+,0]
�II(c)c)=
[
+
]
Then �II(•c)=(0,-]
II(c):ft1 IfIf �II(
=[0] Then �II(•c)=(OJ
If �II( c)=[-] Then �II(•c)= [0]
where �II(x)=[?]is taken to mean �II(x)= [+], [0]
or [-]. Thus possibility theory can represent a wider
range of behaviours than probability theory.
If

However, possibility theory has one major limitation
that is not shared by probability theory, and that is the
fact that it does not have an inverting link. If
increases, it is only possible to have
c) decreasing if
follows it. This restricts
decreases and
the representation to the situation in which
and increases to 1 and this may be inappropriate.

val(•a)

4

A COMPARISON OF THE
THREE FORMALISMS

It is instructive to compare the qualitative behaviours
of the simple link of Figure 1 when the conditional
values that determine its behaviour are expressed us­
ing probability, possibility and evidence theories. This
comparison exposes the differences in approach taken
by the qualitative formalisms, providing some basis for
choosing between them as methods of knowledge rep­
resentation.
One way of representing the possible behaviours that
a link may encode, is to specify the possible values of
and
for given values of
Thus for probability theory we have:

�val
�val((a).•a), �val(c) �val(•c)
�p(a)=
=[[-OJ] Then
p(a)= IfIf �p(a)
Then �p(•a)=[OJ
�p(•a)=[+]
p(a) f; 1 IfIf �p(a)
=
[
+
]
Then �p(•a)=[-]
�p(a)=[0] Then �p(•a)=[OJ
If �p(a)= [-] Then �p(•a)=[+]
For any value of p(a), either [8p(c)\8p(a)J = [+J, or
[8p(c)\8p(a)]=[-],and:
p(c)=1 IfIf �p(c)
�p(c)=
[[0-]J Then
Then �p(•c)= [0]
=
�p(•c)=[+]
p(c) f; 1 IfIf �p(c)
=
[
+
]
Then �p(•c)=[-]
�p(c)=
�p(•c)=[0]
�p(c)
=[[-0]] Then
Then �p(•c)=[+]
1

If

The criterion on which the choice of probability theory
is most likely to depend, is whether or not it is ap­
propriate that
= -] in every case
since it is possible to model this in other formalisms,
and impossible to avoid it in probability theory.

[8val(x)\8val(•x)] [

In possibility theory we have:
Then
Then

�II(•a)
�II(•a)=
=[[?+] ,OJ

val(a)
val(a):ft1

Evidence theory is the least restricted of the three.
Here we have:
Then
If
If
Then
If
:ft
Then
If
Then
If
Then

�bel(•a)
=[(??]]
�bel(a)
=([0-] ]
�bel(a)
=
�bel(•a)
=
�bel(a)
=
[+OJ ]
�bel
(•a)=
[??JJ
�bel(a)
=[
�bel(•a)
=
[
�bel(a)=[-]
�bel(•a)=[?]
For any bel(a), [8bel(c)\8bel(a)J = [+], [0], or [-],
while:
=
[[-0]J Then
bel(c)=1 IfIf �bel(c)
�bel(•c)=[?)
�bel(c)
=
Then �bel(•c)= [?J
�bel(c)=[
+0]] Then
bel(c) f; 1 IfIf �bel(c)
Then �bel(•c)=[?J
=
[
�bel(•c) [?]
If �bel(c)=[-J Then �bel(•c)= [?J
bel(a)=1
bel(a) 1

=

so that there are no restrictions on the changes.
The purpose of this comparison is not to suggest that
one formalism is the best in every situation. Instead,
it is intended as some indication of which formalism is
best for a particular situation. If a permissive formal­
ism is required, then evidence theory may be the best
choice, while probability might be better when a more
restrictive formalism is needed.
5

QUALITATIVE CHA NGES IN
MORE COMPLEX NETWORKS

The analysis carried out in Section 3 allows us to pre­
dict how qualitative changes in certainty value will
be propagated in a simple link between two nodes.
Now, the change at C depends only on the change
at A, and differential calculus tells us that
so the behaviours of such links may
be composed. Thus we can predict how qualitative
changes are propagated in any network, quantified by

8z\8y oy\ox
·

II(a)=1 IfIf �II(a)
�II(a)=
=[[0-]]

val(c)

val(

8z\8x =

On reasoning in networks with qualitative uncertainty

439

- p(z I x,-,y) - p(z l..,x, y)J
EB [ p(z I x, -, y) - p(z 1-,x,-,y)]

probabilities, possibilities or beliefs where every node
has a single parent.

for all x E {b,-,b}, y{c,-,c} and z

E

{d, -,d}.

p(b,c,d) =
b,
c).
Since
B
and C are
I
independent, p(b,c) = p(b)p(c). Using p(x) = 1 p(-,x) and differentiating we find that [8p(d)\8p(b)] =
p(c)[p(d I b, c) - p(d I -,b,c)] + p(-,c)[p(d I b, -,c)- p(d I
-,b,-,c)] = p(c){[p(d b,c) + p(d I -,b,-,c)]- [(p(d I
b, -,c) + p(d I -,b, c)]} + [(p(d I b,-,c)- p(d I ..,b,-,c)].
From this, and similar results for the variation of p(d)
with p(-,b), p(c) and p(-,c), and the way p(-,d) changes
with p(b), p(-,b), p(c) and p( -,c), the result follows. D
Proof:

We have p(d)

=

LbE{b,-,b}cE{c,-,c}

Lbe{b,-,b}cE{c,..,c} p(b,c)p(d

D

I

Figure 2: A more complex network
We now extend these results to enable us to cope with
networks in which nodes may have more than one par­
ent. To do this we consider the qualitative effect of
two converging links such as those in Figure 2. Since
we are only dealing with singly connected networks, B
and C are independent and the overall effect at D is
determined by:

] [:vva�1! ] ]
[
[
����
:
]
[ tl.tl.val(d)
[ &val
] [ &val
-,d]
va/(-,d)
&val
&val
tl.val(b)
[ tl.val(
(4)
-,b)]
&v l
[ [a;:��
[�� ] [����
&va� ! ] l
] [ ��]
[ !:����)]
There are two ways of tackling the network of Figure 2
in probability theory. We can either base our calcula­
tion on probabilities of the form p(d I b) which implies
the simplifying assumption that the effect of B on D
_

b

-,d

b

-,b

0

EB

c

d

0

is independent of the effect of C (and vice versa), or
we can use the proper joint probabilities of the three
events B, C, and D, using values of the form p(d I b,c).

In the first case we assume that the effects of B and
C on D are completely independent of one another
so that the variation of D with B (and D with C) is
just as described by Theorem 3.1, the joint effect being
established by using (4) to obtain:
[ tl.p(d)] =
EB

[����?]
[����?]

0 [.6.p(b)] EB
0 [6.p(c)] EB

[:;�i)]
[:;��)]

0 [6.p(-,b)]
0 [6.p(-,c)]

which gives the same results as the expression given
by Wellman [1990a] for evaluating the same situa­
tion. vVith the other approach, writing the network
as B&C ...... D, we have:
Theorem 5.1: The relation between p(z) and p(x)
for the link B&C ...... D is determined by:

[;=�;�]

=

[p(z I

X,

y) + p(z I

""lX,

-,y)

Thus the way in which for instance p(d) is dependent
upon p(b) is itself dependent upon a term just like the
synergy condition introduced by Wellman, and apply­
ing (4) we get an expression which has a similar be­
haviour to that given by Wellman for a synergetic re­
lation. In possibility theory we have a similar result
to that for the simple link:
Theorem 5.2: The relation between II(x), IT(y) and
II(z), for all x E {b,-,b}, y E {c,..,c}, z E {d,-,d} for
the link B&C ...... D is such that:

(1) II(z) follows II(x) iff II(x,y,z) > sup[II(..,x,y,z),
II(x,-.y,z), II(..,x,-,y,z)] and II(x) < min(II(z I x,y),
II(y)), or II(x,-,y,z) > sup[II(x,y,z), II(..,x,y,z),
II(-,x,..,y,z)] and II(x) < min(II(z I x,-,y),II(-,y)).
(2) II(z) may follow II(x) up iff II(x,y,z) ::::; sup
[IT(-.x,y,z),IT(x,-.y,z),II(..,x,..,y,z)] and II(x) <
min(II(z I x,y), II(y)), or II(x,-.y, z) ::::; sup[II(x,y,
z), II(-,x,y, z), II(-,x, -,y,z)] and II(x) < min(II(z I
x, ..,y), II(-,y)).
(3) II(z) may follow II(x) down iff II(x, y, z) >
sup[ II(-.x,y,z),II(x,-,y,z), II(-,x,-,y, z)] and II(x);:::
min(IT(z I x,y), II(y)), or II(x,-,y,z) > sup[IT(x,y,
z), II(-,x,y, z), II(-,x, -,y,z)] and II(x) 2': min(IT(z I
x,-,y),II(-,y)).
(4) Otherwise II(z) is independent of II(x).
Proof: As for Theorem 3.2, the result may be de­
termined directly from IT(d) = SUPxe{x,..,x},YE{y,-,y}
II(x,y,z) and II(x,y,z) = II(z I x,y)IT(x)II(y). D

When we use belief values we may take the relationship
between B, C and D to be determined by one set of
conditional beliefs of the form bel(d \ b,c), or by two
sets of conditional beliefs of the form bel(dlb). For
conditionals of the form bel(d I b, c) we have:
Theorem 5.3: The relation between bel(z) and bel(x)
for the link B &C ...... D is determined by:

[��::�:�]

=

EB

[bel(z I x,y) - bel(z I x u-,x,y)]
[ bel(z I x,-,y) - bel(z xU -,x, ..,y)]

I

Parsons and Mamdani

440

EB

[bel(z Ix,yU--,y)-bel(z I xU--,x,yU--,y)]
For all x {b,--,b}, y {c,--,c}, z {d,--,d}.
By Dempster's rule of combination, bel(d)
m(b)m(c)bel(dib,c). Now, m(x)
bel
(
x),
m(--,
x
)
bel
(--,x) and m(x U --,x[()bel(d1 -bel
(x)
-bel
(
--,
x
),
so that [8bel(d)\8bel(b)]
I
b,
c)­
bel[(bel(d(dIbIUb,--,cu--,
b,c)]c)-bel[(bel(d(dIbu--,
Ib,-,c)-bel
().d From
Ib U --,this,
b,-,c)]and
b
,
cu--,
c
similar results for the variation of bel(d) with bel(--,b),
c) and
) changes
with
belbel((b),
bel(--,belb),(--,c),
bel(c)andandthebelway
(--,c)belthe(--,dresult
follows.
Thus bel( d) follows bel(b) iff bel(d I b, c)
bel(d I
bu--,
b
,c),
bel
(
d
I
b,--,
c
)
bel
(
d
I
bu--,
b
,--,
c
),
and bel(d I
b,thec Uform
-,c) bel(beld (I db)Iweb Uobtain:
--,b,c U -,c). For conditionals of
B&C--+ D, bel(z) follows
belotherwise
(x) if belfor(z allIx)Forx the
bel{b,--,(link
zixU--,
and is indeterminate
b}, y x) {c,--,
c}, z {d,--,d}.
E

E

E

Proof:
Lb�{ b,-.b},c�{c,-.c}

=

=

=

=

=

Ef)

EB

D

>

>

>

precise rules of probability, possibility and Dempster­
Shafer theory when there is incomplete numerical in­
formation, but it can also provide a way of integrating
the different formalisms.
Consider the following medical example. The network
of Figure 3 encodes the medical information that joint
trauma (T) leads to loose knee bodies (K), and that
these and arthritis (A) cause pain (P). The incidence
of arthritis is influenced by dislocation (D) of the joint
in question and by the patient suffering from Sjorgen's
syndrome (S) Sjorgen's syndrome affects the inci­
dence of vasculitis (V), and vasculitis leads to vas­
culitic lesions (L).
.

T

Theorem 5.4:

�

E

E

E

tells us
bel(dib)m(b)
bel:(d)Dempster's rule of combination
belb)-bel
(dic)m(
a result, [8bel(d)\8bel(b)] [(bel(d I
(d Ic).bu--,Asb)]{bel
(di--,c) [1+bel(c)+bel(--,c)-m(c)]
+bel(di--,c) [1+bel(c)+ bel(-,c)-m(-,c)] +bel(die) [1+
bel(c) + bel(--,c)- m(c U -,c)]}+ bel(dl--,b) [m(c)bel(d I
c)+
m(--,c)bel
(d I-,c)+ m(c U --,c)bel(dic U[+-,c)).
Since
m(x)
1 for all x, [8bel(d)\8bel(b)]
]
if bel(d I
b) bel(dlb U -,b) and [?) otherwise. From this, and
similar results for the variation of bel(d) with bel(--,b),
belbel((b),
c) and
) changes
with
bel(--,belb),(--,c),
bel(c)andandthebelway
(--,c)belthe(--,dresult
follows.
Proof

that

=

Lb�{b,-.b},c�{c,-.c},bvc:Jd

=

:::;

Figure 3: A network representing medical knowledge

=

�

The strengths of these influences are given as proba­
bilities:

D

Thus the formalisms again exhibit differences in be­
haviour across the same network.
The expressions derived in this section are those ob­
tained by using the precise theory of each formalism.
This is important since it ensures the correctness of
the integration introduced in Section 6. However, for
reasoning using single formalisms, it may provde ad­
vantageous to extend the simpler apporach adopted by
Wellman [1990a) to possibility and evidence theories.
Finally a word on the scope of the reasoning that we
can perform as a result of our analysis. The differential
calculus tells us that
=
provided that is not a function of
Thus we can
clearly use the results derived above to propagate qual­
itative changes in probability, possibility and belief
functions through any singly connected network.

x .6-z Ax· [8z\8x]y.+ .6-y [8z\8y],
·

6

INTEGRATION THROUGH

p(k II --,t)t)
p(k
p(a
p(a II d,s)
d,--,s)

0.6
0.2
0.9
0.6

p(v IIs)--,s)
p(v
p(a
p(a 1--,d,
I--,d,s)--,s)

0.1
0.3
0.6
0.4

beliefs:

belbelbel(((ppp III k,--,a)a)a)
belbel((pp II UaU -,a)a)
belbel((--,--,pp II aU
-,a) -,a)
k,

--,k,
k --,k,
k,
--,k,
--,k,

=

=

0.9
0.7
0.7
0.6
0.7
0.5
0.4

All other conditional beliefs are zero
and possibilities:

QUALITATIVE CHANGE

The work described in this paper so far has extended
qualitative reasoning about uncertainty handling for­
malisms to cover possibility and belief values as well
as probability values. Not only is this useful in it­
self in providing a means of reasoning according to the

IT(l
II(-,/i v)Iv)

1
0.1

II(/ I/1--,
--,v)v)
II(--,

1
0.1

We can integrate this information allowing us to say
how our belief in the patient in question being in pain,

On reasoning in networks with qualitative uncertainty

and the possibility that the patient has vasculitic le­
sions, vary when we have new evidence that she is
suffering from Sjorgen's syndrome. From the new ev­
= [-] ,
=
idence we have
= [+],
[0],
= [0],
= [0] and
= [0]. Since
a change of [0] can never become a change of [+] or [-]
we can ignore the latter changes. Now, from Theorem
3.1 and Theorem 5.1 we know that:

�p(-.t) �p(s)
�p(d)

�p(-.�p(
s) -.d) �p(t)

[8p(v)] [-] [ 8p(v) ] [+]
8p(-.s)
8p(s)
[8p(a)] = [+] [ 8p(a) ] = [-]
8p(-.s)
8p(s)
so that �p(a) = [+], and �p(v) =[-] from which we
can deduce that �p(-.a) = [-] and �p(-.v) = [+].
=

=

To continue our reasoning we need to establish the
change in belief of and the change in possibility of
To do this we make the monotonicity assumption
[Parsons 1993] that if the probability of a hypothesis
increases then both the possibility of that hypothesis
and the belief in it do not decrease. As well as being
intuitively acceptable, this assumption is the weakest
sensible relation between values expressed in different
formalisms, and is compatible both with the principle
of consistency between probability and possibility val­
ues laid down by Zadeh [1978] and the natural exten­
sion of this principle to belief, necessity [Dubois and
Prade 1988b], and plausibility values.

l.

a

The assumption also says that if the probability de­
creases then the possibility and belief do not increase,
and so we can say that
[+, OJ,
=
[-, 0],
[- , 0] and
= [+, 0]. Now we
apply Theorem 5.3 to find that:

�bel(�II(-.v)
a)= �bel(-.a)
�II(v)=
[8bel(p)] = [+] [ 8bel(p) ] = [O]
8bel(a)
8bel(-.a)
[8bel(-.p)] = [-] [8bel(-.p)] = [+]
8bel(a)
8be/(-.a)
Since we are initially ignorant about the possibility of
vasculitis, we have II(v) = II(-.v) = 1, so that Theo­
rem 3.2 gives:
[ 8p(l)] = [0] [ 8p(l) ] = [0]
8p(v)
8p(-.v)
[8p(-.l)] =(OJ [8p(-.l)] =[OJ
8p(-.v)
8p(v)
Hence we can tell that �bel(p) = [+, 0], bel(-.p)
[- , OJ and �II(v) = �II(-.v) = [OJ. The result of the

new evidence is that belief in the patient's pain may in­
crease, while the possibility of the patient having vas­
culitic lesions is unaffected. Thus we can use numeri­
cal values and qualitative relationships from different
uncertainty handling formalisms to reason about the
change in the belief of some event given information
about the probability of a second event, and can in­
fer whether the possibility of a third event also varies.
As a result reasoning about qualitative change allows
some integration between formalisms.

7

441

DISCUSSION

There is an important difference between the approach
to qualitative reasoning under uncertainty described
here, and that of Wellman [1990a, bJ. Despite their
name, Wellman's Qualitative Probabilistic Networks
do not describe the qualitative behaviour of probabilis­
tic networks exactly. In particular, some dependencies
between variables are ignored in favour of simplicity,
and synergy relations are sometimes introduced to rep­
resent them where it is considered to be important.
In our approach, since it is based directly upon the
various formalisms, the qualitative changes predicted
are exactly those of the quantitative methods. This
has been demonstrated in [Parsons and Saffiotti 1993J
which analyses the representation of a real problem in
a number of different qualitative and quantitative for­
malisms. In this analysis we make qualitative predic­
tions about the impact of evidence of faults in an elec­
tricity distribution network and compare these with
the real quantitative changes. In every ca<;e, for proba­
bility, possibility and belief values, the qualitative pre­
dictions were correct. This verification is a good in­
dication of the validity of the approach, and suggests
that it will be useful in situations where incomplete
information prevents the application of quantitative
methods.
Our qualitative method also provides a means of in­
tegrating uncertainty handling formalisms on a purely
syntactic basis. For any hypothesis x about which we
have uncertain information expressed, say in proba­
bility theory and possibility theory, we can make the
intuitively reasonable assumption that if x ) increases
II( x ) does not decrease, and thus translate from proba­
bility to possibility without worrying what probability
or possibility actually mean.

p(

As a result any desired semantics may be attached
to the values, a feature which finesses the problem of
the acceptability of the semantics which must be faced
by other, semantically based, schemes for integration
(eg. [Baldwin 1991]). The only problem with switch­
ing semantics would be that some combination rules
might no longer apply, Dempster's rule in the case of
Baldwin's voting model semantics, which would entail
a re-derivation of the appropriate propagation condi­
tions. Since the qualitative approach does not a priori,
rule out any combination scheme, this is not a major
difficulty.
Finally, there is one important way that this method
might be improved. The main disadvantage of any
qualitative system is that there is no distinction be­
tween small values and large values, so 0.001 is qualita­
tively the same as 100, 000. As a result we cannot dis­
tinguish between evidence that induces small changes
in the certainty of a hypothesis and evidence that in­
duces large changes. This problem has been recognised
for some time, and there is now a large body of work
on order of magnitude reasoning (for example [Raiman

442

Parsons and Mamdani

1986], [Parsons and Dohnal 1992]) which attempts to
automate reasoning of the form it "If A is bigger than
B and B is bigger than C then A is bigger than C".
The applications to our system are obvious, and we
intend to do some work on this in the near future.
8

SUMMARY

This paper has introduced a new method for qualita­
tive reasoning under uncertainty which is equally ap­
plicable to all uncertainty handling techniques. All
that need be done to find the qualitative relation be­
tween two values is to write down the analytical ex­
pression relating them and take the derivative of this
expression with respect to one of the values. This fact
was illustrated by results from the qualitative analysis
of the simplest possible reasoning networks in each of
the three most widely used formalisms.
Having established the qualitative behaviours of prob­
ability, possibility and evidence theories, the differ­
ences between these behaviours were discussed at some
length, before knowledge of this behaviour was used to
establish a form of qualitative integration between for­
malisms. In this integration numerical and qualitative
data expressed in all three formalisms was used to help
derive the change in belief of one node in a directed
graph and the possibility of another from knowledge
of a change in the probability of a third, related, node.
Acknowledgements

The work of the first author was partially supported
by a grant from ESPRIT Basic Research Action 3085
DRUMS, and he is endebted to all of his colleagues on
the project for their help and advice.
Special thanks are due to Mirko Dohnal, Didier
Dubois, John Fox, Frank Klawonn, Paul Krause,
Rudolf Kruse, Henri Prade, Alessandro Saffiotti and
Philippe Smets for uncomplaining help and construc­
tive criticism. The anonymous referees also made a
number of useful comments.

Re-entrant Structural Phase Transition in a Frustrated Kagome
Magnet, Rb2SnCu3F12
Lewis J. Downiea, Stephen P. Thompsonb, Chiu C. Tangb, Simon Parsonsc and Philip Lightfoot*a
Rb2SnCu3F12 has been studied using synchrotron powder Xray diffraction, powder neutron diffraction and single crystal
X-ray diffraction at a range of temperatures (100 – 500 K). A
broad but clear phase transition, possibly of re-entrant
character, is found to occur in the powder form, whereas the
corresponding transition is not seen in the single crystal.
Frustrated magnetism has been of great interest to both physicists
and chemists for a long time due to the unusual effects and
phenomena that it can encourage1,2. These can include spin
glasses, spin ices 3,4 and spin liquids5. In the spin liquid (or
‘resonating valence bond’) state6 there is such a high level of
frustration that any tendency towards long-range magnetic order
is suppressed, even down to 0 K. This is of great fundamental
interest as such a state may help the understanding of, for
example, high-temperature superconductivity.
Magnetic frustration is often manifested in crystal structures
containing triangular motifs of magnetic species, such as those
based on the kagome lattice. In the specific case of kagome
lattices based on S = ½ ions (where the competition between
long-range ordering and quantum fluctuation effects is strongest)
there have been several recently reported examples of spin liquidlike behaviour. Key examples are the Cu2+-based systems
Herbertsmithite7 and Kapellasite8, and the V4+ system
[NH4]2[C7H14N][V7O6F18]9,10. Each of these examples has been
shown to display persistent spin fluctuations down to below 50
mK. A related phenomenon, the so-called ‘valence-bond solid’
or VBS state, in which localised, static spin-pairing exists, but
still without long-range cooperative interactions, occurs in the
compound Rb2SnCu3F12. This is an attractive system for
exploring crystal-chemical influences on frustration due to the
chemical flexibility inherent within the wider A2MCu3F12
family11. Some members of this family are reported to have a
structural phase transition below room temperature which distorts
their perfect kagome lattice12,13 and therefore affects their
preferred magnetic ground state.
The crystal structure of
Rb2SnCu3F12 has only been examined in detail at room
temperature14, although some evidence for a phase transition near
215 K has been suggested15. Even at room temperature,
Rb2SnCu3F12 does not possess a perfect Cu2+ kagome lattice. A
structural frustration, perhaps caused by the incorporation of the
smaller Rb+ rather than Cs+ cation, leads to a lowering of
symmetry (specifically a doubling of the a and b parameters of
the rhombohedral unit cell) and a disorder of the fluoride
sublattice, when compared to the previously well characterised
analogues Cs2ZrCu3F12 and Cs2SnCu3F12. These models are
herein referred to as ‘Rhomb-1’ and ‘Rhomb-2’ as shown in
Figure 1. The lowering of symmetry is suggested to be
intrinsically related to the adoption of the unique VBS ground
state, since it gives rise to four, rather than one, independent Cu--Cu superexchange pathways15. This contrasts with the longrange antiferromagnetic order seen in the other family members.

Fig 1.: Unit cell of A2MCu3F12 looking down the c-axis. Red outline is
the aristotype unit cell (Rhomb-1) common to Cs2ZrCu3F12 and
Cs2SnCu3F12; yellow outline is the doubled cell (Rhomb-2) found for
Rb2SnCu3F12.

Considering these differences it is of interest to probe the
structural behaviour of Rb2SnCu3F12 at low temperature, in order
to compare and contrast to the structural and magnetic behaviour
of Cs2ZrCu3F12.
The target compound was synthesised by an adaptation of the
previously reported procedure14. RbF (Sigma Aldrich 99.8 %)
and SnF4 (Sigma Aldrich) were dried at 120 °C under vacuum for
approximately 20 hours. They were then mixed and ground with
CuF2 (Sigma Aldrich 98%) under argon in the molar
stoichiometric ratio 2:1:3 before sealing in a gold tube. The tube
was then heated under flowing argon at 10 °C min-1 to 600 °C for
twelve hours before cooling at the same rate. In the case of single
crystals the molar ratio was adjusted to 3:2:3 (in order to provide
a flux for crystal growth), the temperature to increased 800 °C
and the cooling rate slowed to ~ 3 °C hr-1. In all cases it was very
difficult to synthesise the pure Rb2SnCu3F12 phase, with
significant impurities being Rb2SnF6 and CuO. In the powder
diffraction experiments we were able to adequately account for
these using multiphase Rietveld refinements16,17 – see ESI for
further details.

Fig 2.: Portion of synchrotron powder diffraction pattern for Rb 2SnCu3F12
at various temperatures.

Synchrotron X-ray powder diffraction experiments were
performed at beamline I11, Diamond Light Source18. In this first
experiment (Run 1), data were recorded at room temperature
before quickly cooling to 100 K and allowing equilibration,
before increasing the temperature. The room temperature data
were well fitted by the proposed Rhomb-2 model (large cell,
Figure 1; space group R-3, with a ~ 13.9 Å, c ~ 20.3 Å)
previously derived from single crystal data14. Specifically it was
confirmed that the doubling of the aristotype unit cell was
required. At around 250 K – on cooling – however, it was found
that visible splittings occurred in some of the diffraction peaks.
There are two possible causes of these splittings: a phase
separation to two very similar phases, or a phase transition to a
single, lower symmetry phase. A thermally-induced phase
separation has recently been reported in the multiferroic fluoride
KxFeF319. In the present case, the simplest model was tested: ie
two Rhomb-2 like phases with differing lattice parameters and
phase fractions. This model failed to account for the observed
splittings. Initial modelling using a single lower symmetry phase
was attempted using a monoclinic model which had previously
been derived for the Cs2ZrCu3F12 system12; however, this was
unable to explain some superstructure peaks necessitated by the
‘doubled’ cell. By considering the possible distortions of the
parent phase (using the ISODISTORT program20) a triclinic
model was found to account for all the observed peaks (see ESI
for full details). This model (a maximal non-isomorphic subgroup
of Rhomb-2) provides the most plausible explanation of the
observed data. However, due to its complexity, and the issues of
sample purity, it was not possible to refine full details of this
model; nevertheless, high-quality fits were obtained by refining
only the lattice and profile parameters. Further cooling – to
approximately 190 K – leads to the disappearance of this splitting
and a return to a pattern which is well fitted by the Rhomb-2
model (Fig. 2 and 4). In order to probe this phenomenon further,
and to confirm that this apparent re-entrant phase transition is not
an artefact due to sluggish kinetics, the experiment was repeated,
this time using both heating and slow-cooling cycles (Run 2). The
sample was cooled slowly from 300 K to 165 K (below the
suggested transition) and heated to 300 K again, with several data
collections carried out during each ramp. In this case it was
found that – visually at least – there was a clear transition from
the Rhomb-2 to the triclinic phase, and back to the Rhomb-2
phase on both heating and cooling. Rietveld refinement showed a
hysteresis in the phase transition temperature and a mixed-phase
zone in both directions, both suggestive that the phase transition
is 1st order in nature.
To obtain a definitive structure for the intermediate triclinic
phase and to investigate the relationship between the low
temperature and room temperature rhombohedral phases, single
crystal X-ray diffraction was performed. Data were collected on
two separate crystals. In the first experiment a crystal was
mounted at 220 K. After data collection, the crystal was warmed
to 300 K, cooled to 230 K and then warmed to 245 K. To our
surprise, all three datasets, collected at 220, 230 and 245 K were
indexable and refined well in the Rhomb-2 model, with R-factors
of around 5% in each case (see ESI for details). It was also
found that the previously reported structural disorder was present

Fig 3.: Percentage of Rhomb-2 phase present in two samples.

at all three temperatures. In a second single crystal experiment
data were collected at 300, 245 and 140 K on cooling: in this case
the quality of the refinement using the same Rhomb-2 model was
inferior at 140 K to that at 245 K (R1 values of 5.62% and 3.49%,
respectively). Significantly, there was no evidence for loss of
three-fold symmetry, however, re-integrating the 140 K data in a
much larger and lower symmetry unit cell (model ‘Trig-1’, space
group P-3, a ~ 27.8 Å, c ~ 20.3 Å) , as tentatively suggested by
Matan et al.15, did reveal some evidence for additional very weak
scattering in the enlarged cell. The weakness of these possible
superlattice reflections precluded any reasonable refinement. We
re-iterate that this enlarged, but high-symmetry, unit cell does not
account for the peak splittings seen in the intermediate (triclinic)
phase in our powder experiments.
In order to further explore the reproducibility of the powder
experiments an analogous experiment was carried out using
powder neutron diffraction (see ESI for details). It was found
that further refinement for full structural details was prohibited

Fig. 4: Rietveld fits to the synchrotron powder data at different
temperatures. In this case only single Rb2SnCu3F12 phases were used
(Rhomb-2 model at 300 and 165 K, triclinic model (P-1) at 220 K. Red
tick-marks correspond to Rb2SnCu3F12, orange to Rb2SnF12 and blue to
RbCuF3.

due to impurity levels but at room temperature and 150 K the
pattern was successfully fitted in the Rhomb-2 model and at 220
K in the triclinic cell. This confirmed the essential behaviour
proposed in the synchrotron powder experiments.
From the present study it is clear that powder samples of
Rb2SnCu3F12 show curious and hitherto unreported phase
transition behaviour. The reproducible transition from
rhombohedral to triclinic to rhombohedral phases on cooling and
re-heating strongly suggests a re-entrant structural phase
transition. Unfortunately, the exact details of each crystal
structure cannot be ascertained from the powder diffraction data
alone, and both the present and previous single crystal studies
clearly show behaviour different to all the present powder-based
studies. In particular it is not clear whether the two ‘Rhomb-2’
phases surrounding the triclinic phase are truly identical or
whether they differ, for example, in the degree or nature of the
fluoride disordering.
Purely structural re-entrant phase transitions in crystalline
materials are very rare. A recent study suggests only three known
examples21; this has now been supplemented by one further
possible case22. Interestingly, in the latter case, the transformation
has the same group-subgroup relationship (R-3 to P-1) as
presented here, though it is suggested that the transition is due to
competition between a weak Jahn-Teller effect and magnetic
ordering; in our case the cause is more likely to be purely
structural and related to the fluorine disorder.

Notes and



Qualitative probabilistic networks have been de­
signed for probabilistic reasoning in a qualita­
tive way. Due to their coarse level of represen­
tation detail, qualitative probabilistic networks
do not provide for resolving trade-offs and typ­
ically yield ambiguous results upon inference.
We present an algorithm for computing more in­
sightful results for unresolved trade-offs. The al­
gorithm builds upon the idea of using pivots to
zoom in on the trade-offs and identifying the in­
formation that would serve to resolve them.
1

INTRODUCTION

Qualitative probabilistic networks were introduced in the
early 1990s for probabilistic reasoning with uncertainty in
a qualitative way [Wellman, 1990]. A qualitative prob­
abilistic network encodes variables and the probabilistic
relationships between them in a directed acyclic graph.
The encoded relationships basically represent influences on
probability distributions. Each of these influences is sum­
marised by a qualitative sign indicating the direction of
shift in one variable's distribution occasioned by a shift in
another variable's distribution. For probabilistic inference
with qualitative networks, an elegant algorithm based upon
the idea of propagating and combining signs is available
[Druzdzel & Henrion, 1993a] .
Qualitative probabilistic networks capture the relationships
between their variables at a coarse level of representation
detail. As a consequence, these networks do not provide
for resolving trade-offs, that is, for establishing the net re­
sult of two or more conflicting influences on a variable's
probability distribution. If trade-offs are represented in a
qualitative network, then probabilistic inference will typi­
cally yield ambiguous results. Once an ambiguity arises,
it will spread throughout most of the network upon infer­
ence, even if only a very small part of the network is truly
ambiguous.

The issue of dealing with trade-offs in qualitative prob­
abilistic networks has been addressed before by several
researchers. S. Parsons has introduced, for example, the
concept of categorical influences. A categorical influence
is either an influence that serves to increase a probability
to 1 or an influence that decreases a probability to 0, re­
gardless of any other influences, and thereby resolves any
trade-off in which it is involved [Parsons, 1995] . C.-L. Liu
and M. P. Wellman have designed a method for resolving
trade-offs based upon the idea of reverting to numerical
probabilities whenever necessary [Liu & Wellman, 1998].
S. Renooij and L.C. van der Gaag have enhanced the ba­
sic formalism of qualitative probabilistic networks by dis­
tinguishing between strong and weak influences. Trade­
off resolution during inference is then based on the idea
that strong influences dominate over conflicting weak ones
[Renooij & Van der Gaag, 1999] . These approaches to
trade-off resolution are all based on a refinement of the rep­
resentation used in the basic formalism.
In this paper, we present a new algorithm for dealing with
trade-offs in qualitative probabilistic networks. Rather than
resolving trade-offs by providing for a finer level of rep­
resentation detail, our algorithm identifies the information
that would serve to resolve the trade-offs present in a quali­
tative probabilistic network. From this information, a more
insightful result than ambiguity is constructed.
Our algorithm for dealing with trade-offs builds upon the
idea of zooming in on the part of a qualitative probabilis­
tic network where the actual trade-offs reside. After a new
observation has been entered into the network, probabilis­
tic inference will provide the sign of the influence of this
observation on the variable of interest, given previously en­
tered observations. If this sign is ambiguous, then there are
trade-offs present in the network. In fact, a trade-off must
reside along the reasoning chains between the observation
and the variable of interest. Our algorithm isolates these
reasoning chains to constitute the part of the network that
is relevant for addressing the trade-offs present. From this
relevant part, an informative result is constructed for the
variable of interest in terms of values for the variables in-

516

UNCERTAINTY IN ARTIFICIAL INTELLIGENCE PROCEEDINGS 2000

volved and the relative strengths of the influences between
them.
We believe that qualitative probabilistic networks can play
an important role in the construction of quantitative proba­
bilistic networks for real-life application domains, as well
as for explanation of their reasoning processes. The con­
struction of a probabilistic network typically sets out with
the construction of the network's digraph. As the assess­
ment of the various probabilities required is a far harder
task, it is performed only when the network's digraph is
considered robust. Now, by assessing signs for the influ­
ences modelled in the digraph, a qualitative network is ob­
tained that can be exploited for studying the projected prob­
abilistic network's reasoning behaviour prior to the assess­
ment of its probabilities. For this purpose, algorithms are
required that serve to derive as much information as possi­
ble from a qualitative probabilistic network. We look upon
our algorithm as a first step to this end.
The paper is organised as follows. In Section 2, we pro­
vide some preliminaries concerning qualitative probabilis­
tic networks. In Section 3, we introduce our algorithm for
zooming in on trade-offs informally, by means of an ex­
ample. The algorithm is discussed in further detail in Sec­
tion 4. The paper ends with some concluding observations
in Section 5.
2

PRELIMINARIES

A qualitative probabilistic network encodes the statistical
variables from a domain of application and the probabilis­
tic relationships between them in a directed acyclic graph
G
(V(G) , A(G) ) . Each node in the set V(G) repre­
sents a statistical variable. Each arc in the set A(G) can be
looked upon as expressing a causal influence from the node
at the tail of the arc on the node at the arc's head. More for­
mally, the set of arcs captures probabilistic independence
among the represented variables. We say that a chain be­
tween two nodes is blocked if it includes either an observed
node with at least one outgoing arc or an unobserved node
with two incoming arcs and no observed descendants. If
all chains between two nodes are blocked, then these nodes
are said to be d-separated and the corresponding variables
are considered conditionally independent given the entered
observations [Pearl, 1988] .
=

A qualitative probabilistic network associates with its di­
graph G a set � of qualitative influences and synergies
[Wellman, 1990] . A qualitative influence between two
nodes expresses how the values of one node influence the
probabilities of the values of the other node. A positive
qualitative influence of node A on its successor B expresses
that observing higher values for A makes higher values for
B more likely, regardless of any other direct influences on
B; the influence is denoted S6(A, B) , where'+' is the in­
fluence's sign. A negative qualitative influence, denoted

S(j, and a zero qualitative influence, denoted S2,, are de­
fined analogously. If the influence of node A on node B
is not monotonic or unknown, we say that it is ambiguous,
denoted Sb(A, B) .
The set of influences of a qualitative probabilistic net­
work exhibits various properties [Wellman, 1990] . The
property of symmetry states that, if the network includes
the influence Sb(A, B) , then it also includes Sb(B, A) ,
J E { +, -, 0, ?}. The property of transitivity asserts that
qualitative influences along a simple chain that specifies at
most one incoming arc for each node, combine into a single
influence with the ®-operator from Table 1. The property
of composition asserts that multiple influences between two
nodes along parallel chains combine into a single influence
with the EB-operator.
Table 1: The ®- and EB-operators.
0
+

+
+

0
?

0
?

+
0
?

0
0
0
0
0

?
?
0
?

EB
+

+
+
?

0

?

0
?

+
?

0
?

?
?
?

?

In addition to influences, a qualitative probabilistic net­
work includes synergies that express how the value
of one node influences the probabilities of the values
of another node in view of a value for a third node
[Druzdzel & Henrion, 1993b] . A negative product synergy
of node A on node B (and vice versa) given the value c for
their common successor C, denoted X0 ({A, B}, c) , ex­
presses that, given c, higher values for A render higher val­
ues for B less likely. Positive, zero, and ambiguous prod­
uct synergies are defined analogously. A product synergy
induces a qualitative influence between the predecessors of
a node upon observation of that node; the induced influence
is coined an intercausal influence. In this paper, we assume
that induced intercausal influences are added to a qualita­
tive probabilistic network's graph as undirected edges.
procedure PropagateSign(from,to,message):

sign[to] � sign[to] EB message;
for each (induced) neighbour Vi of to
do linksign � sign of (induced) influence
between to and Vi;
message � sign[to] 0 linksign;
if Vi #from and Vi � Observed
and sign[Vi] =I= sign[Vi] EB message
then PropagateSign(to, Vi,message)

Figure 1: The Sign-propagation Algorithm.
For probabilistic inference with a qualitative probabilis­
tic network, an elegant algorithm is available from
M.J. Druzdzel and M. Henrion (1993a); this algorithm is
summarised in pseudocode in Figure 1. The basic idea of
the algorithm is to trace the effect of observing a node's
value on the other nodes in a network by message-passing

UNCERTAINTY IN ARTIFICIAL INTELLIGENCE PROCEEDINGS

between neighbouring nodes. For each node, a node sign
is determined, indicating the direction of change in the
node's probability distribution occasioned by the new ob­
servation given all previously observed node values. Ini­
tially, all node signs equal ' 0'. For the newly observed
node, an appropriate sign is entered, that is, either a '+'
for the observed value true or a '-' for the value false,
by calling PropagateSign(observed node, observed node, sign).
Each node receiving a message updates its sign and sub­
sequently sends a message to each neighbour that is not
d-separated from the observed node and to every node on
which it exerts an induced intercausal influence. The sign
of this message is the 0-product of the node's (new) sign
and the sign of the influence it traverses. This process is re­
peated throughout the network, building on the properties
of symmetry, transitivity, and composition of influences.
The process repeatedly visits each node that needs a change
of sign. Since a node can change sign at most twice, once
from 0 to +or-, and then only to ?, each node is visited
at most twice. The process is therefore guaranteed to halt.
3

OUTLINE OF THE ALGORITHM

If a qualitative probabilistic network models trade-offs, it
will typically yield ambiguous results upon inference with
the sign-propagation algorithm. From Table 1, we have
that whenever two conflicting influences on a node are
combined with the EEl-operator, an ambiguous sign will re­
sult. Once an ambiguous sign is introduced, it wil.l spread
throughout most of the network and an ambiguous sign is
likely to result for the node of interest. By zooming in on
the part of the network where the actual trade-offs reside
and identifying the information that would serve to resolve
these trade-offs, a more insightful result can be constructed.
We illustrate the basic idea of our algorithm to this end.

2000

517

Figure 3: The Result of Propagating '+' for NodeH.
has been observed for the node H and that we are inter­
ested in its influence on the probability distribution of node
A. Tracing the influence of the node sign'+' for nodeH,
indicating its observed value, on every node's distribution
by means of the sign-propagation algorithm, results in the
node signs shown in Figure 3. These signs reveal that at
least one trade-off must reside along the reasoning chains
between the observed node H and the node of interest A.
These chains together constitute the part of the network that
is relevant for addressing the trade-offs that have given rise
. to the ambiguous result for node A; we term this part the
relevant network. For the example, the relevant network is
shown in Figure 4 below the dashed line. Our algorithm
now isolates this relevant network for further investigation.
To this end, it deletes from the network all nodes and arcs
that are connected to, but no part of the reasoning chains
fromH to A.
A relevant network for addressing trade-offs typically in­
cludes many nodes with ambiguous node signs. Often,
however, only a small number of these nodes are actually
involved in the trade-offs that have given rise to the am­
biguous result for the node of interest. Figures 3 and 4,
for example, reveal that, while the nodes A, B, and C have
ambiguous node signs, the influences between them are not
conflicting. In fact, every possible unambiguous node sign
sign[C] for node C would result in the unambiguous sign
sign[C]0 ( ( +0-) EB-) sign[C]0- for node A. For
addressing the trade-offs involved, therefore, the part of the
relevant network between node C and node A can be dis­
regarded. Node C in fact separates the part of the relevant
network that contains trade-offs from the part that does not.
We call node C the pivot node for the node of interest.
=

Figure 2: The Example Qualitative Probabilistic Network.
As our running example, we consider the qualitative proba­
bilistic network from Figure 2. Suppose that the value true

In general, the pivot node in a relevant network is a node
with an ambiguous sign for which every possible unam­
biguous sign would uniquely determine an unambiguous
sign for the node of interest; in addition, no other node hav­
ing this property resides on an unblocked chain from the

518

UNCERTAINTY IN ARTIFICIAL INTELLIGENCE PROCEEDINGS 2000

Figure 5: The Construction of a Sign for Node C.
network, the nodes from the resolution frontier exert two
separate influences on the pivot node C: the influence from
node I via node Don C and the influence from G on C.
For the sign 8 of the influence of node I via node Don C
and for the sign o' of the influence of G on C, we find that

8
Figure 4: The Relevant Network, below the Dashed Line.
observed node to the pivot node, that is, the pivot node is
the node with this property "closest" to the observed node.
Note that every network includes such a node. Our algo­
rithm now selects from the relevant network the pivot node
for the node of interest.
From the definition of pivot node, it can be shown that there
must be two or more different reasoning chains in the rel­
evant network from the observed node to the pivot node;
the net influences along these reasoning chains, moreover,
must be conflicting or ambiguous. To resolve the ambiguity
at the pivot node, the relative strengths of the various influ­
ences as well as the signs of some of the nodes involved
need be known. From Figures 3 and 4, for example, we
have that node I lies at the basis of the ambiguous sign for
the pivot node C. Note that it receives an ambiguous node
sign itself as a result of two conflicting (non-ambiguous)
influences. An unambiguous node sign for node I would
not suffice to fix an unambiguous sign for node C. Even
knowledge of the relative strengths of the two conflicting
influences from node I on the pivot node would not suf­
fice for this purpose, however: a positive node sign for
node I, for example, would still cause node G, residing
on one of the reasoning chains from I to C, to receive an
ambiguous node sign, which in tum gives rise to an am­
biguous influence on C. Node G therefore also lies at the
basis of the ambiguity at the pivot node. Now, every com­
bination of unambiguous node signs for the nodes G and
I would render the separate influences on the pivot node
unambiguous. Knowledge of the relative strengths of these
influences would suffice to determine an unambiguous sign
for the pivot node. We call a minimal set of nodes having
this property the resolutionfrontier for the pivot node.
In terms of signs for the nodes from the resolution frontier,
our algorithm now constructs a (conditional) sign for the
pivot node by comparing the relative strengths of the vari­
ous influences exerted on it upon inference. In the example

=

=

sign[I] 0 81 0 83
sign[I]0 +

8'

=

=

sign[G] 0 84
sign[G]0-

where Di, i
1, 3, 4, are as in Figure 5. For the node sign
sign[C] of the pivot node, the algorithm now constructs the
=

following result:
if 181 2: 10'1, then sign[C]

=

8, else sign[C]

=

8';

where 181 denotes the strength of the sign 8. So, if the two
influences on node C have opposite signs, then their rela­
tive strengths will determine the sign for node C. The sign
of the node of interest A then follows directly from the node
sign of C.
4

SPLITTING UP AND CONSTRUCTING
SIGNS

In this section we detail some of the issues involved in our
algorithm for pivotal pruning of trade-offs. In doing so, we
assume that a qualitative probabilistic network does not in­
clude any ambiguous influences, that is, ambiguous node
signs upon inference result from unresolved trade-offs. We
further assume that observations are entered into the net­
work one at a time. We also assume that sign propagation
resulted in an ambiguous sign for the network's node of in­
terest. For ease of reference, Figure 6 summarises the zoom
algorithm in pseudocode.
procedure PivotalPruning(Q):

Qrel +-- ComputeRelevantNetwork(Q);
pivot+-- ComputePivot(Qrel);
ConstructResults(Qrel ,pivot)

Figure 6: The Basic Algorithm.
In detailing the algorithm, we focus attention on identify­
ing the relevant part of a qualitative probabilistic network
along with its pivot node and on constructing from these an
informative result for the node of interest.

UNCERTAINTY IN ARTIFICIAL INTELLIGENCE PROCEEDINGS

4.1

IDENTIFYING THE RELEVANT NETWORK

Our algorithm identifies from a qualitative probabilistic
network the relevant part for addressing the trade-offs that
have resulted in an ambiguous sign for the node of inter­
est. We begin by formally defining the concept of relevant
network.
Definition 1 Let Q
(G, �) be a qualitative probabilistic
network as defined in Section 2. Let 0 be the set of previ­
ously observed nodes in Q, let E be the node for which new
evidence has become available, and let I be the network's
node of interest. The relevant network for E and I given
0 is the qualitative probabilistic network Qrel
(G', �')
such that
=

=

•

•
•

V(G') consists of all nodes that occur on a chain from

E to I that is not blocked by 0;

A(G')

=

(V(G')

x

V(G') ) n A(G) ; and

�' consists of all qualitative influences and synergies
from � that involve nodes from G' only.

The concept of relevance has been introduced before, most
notably for quantitative probabilistic networks (see for ex­
ample [Druzdzel & Suermondt, 1994, Shachter, 1998]). In
fact, for quantitative and qualitative probabilistic networks
various different concepts of relevance have been distin­
guished. For a node of interest I, previously observed
nodes 0, and a newly observed nodeE, we say that a node
N is
•

structurally relevant to I, if N is not d-separated from
I given 0 U {E};

•

•

519

computationally nor dynamically relevant to the node of
interest A.
The concept of dynamic relevance was introduced to de­
note the nodes constituting the reasoning chains between a
newly observed node and a node of interest in a probabilis­
tic network [Druzdzel & Suermondt, 1994]. The set of all
nodes that are dynamically relevant to the node of interest
I and the newly observed nodeE, given the previously ob­
served nodes 0, can in fact be shown to induce the relevant
network forE and I given 0, as defined in Definition 1.
From a qualitative probabilistic network, the set of dy­
namically relevant nodes can be established by first deter­
mining all nodes that are computationally relevant to the
node of interest I and then removing the nodes that are not
on any reasoning chain from the newly observed node E
to I. For computing the set of all computationally rele­
vant nodes, the efficient Bayes-Ball algorithm is available
from R.D. Shachter (1998). The algorithm takes for its in­
put a probabilistic network, the set of all observed nodes
0 U {E}, and the node of interest I; it returns the sets
of nodes that are computationally relevant, or requisite,
to I. From the set of computationally relevant nodes, all
nodes that are not on any reasoning chain from the newly
observed node E to the node of interest I need be iden­
tified; these nodes are termed nuisance nodes for E and
I. An efficient algorithm is available for identifying these
nodes [Lin & Druzdzel, 1997]. The algorithm takes for its
input a computationally relevant network, the set of previ­
ously observed nodes 0, the newly observed node E, and
the node of interest I; it returns the set of nuisance nodes
for E and I. The algorithm for computing the relevant
part of a qualitative probabilistic network is summarised
in pseudocode in Figure 7.
function ComputeRelevantNetwork(Q):

computationally relevant to I, if the (conditional)
probabilities for N are required for computing the
posterior probability distribution for I given the ob­
servations for 0 U {E}; and

Qrel

requisites+--- BayesBaii(G, 0 U {E}, I);
V(G)+--- (V(G) \requisites) U {E};
A(G) +--- (V(G) x V(G)) n A(G);
nuisances+--- ComputeNuisanceNodes(G);
V(G)+--- V(G) \ nuisances;
A(G)+--- (V(G) x V(G)) n A(G);
L1 +--- {all influences and synergies from L1 in G};
return Qrel
(G, L1)

dynamically relevant to I andE, if N partakes in the
impact of E on I in the presence of the observations
forO.

In our example qualitative network, node D is structurally
relevant, computationally relevant, and dynamically rele­
vant to the node of interest A. NodeE is structurally rele­
vant to node A yet neither computationally nor dynamically
relevant. Node J is structurally irrelevant to the observed
nodeH, as is also evidenced by its node sign '0' upon in­
ference; it is both structurally and computationally relevant
to the node of interest A, yet dynamically irrelevant. The
newly observed node H is d-separated from A by its be­
ing observed. It therefore is not structurally relevant to A;
it is computationally as well as dynamically relevant to A,
however. Node M, to conclude, is neither structurally nor

2000

=

Figure 7: The Algorithm for Computing the Relevant Net­
work.
4.2

IDENTIFYING THE PIVOT NODE

After establishing the relevant part of a qualitative proba­
bilistic network for addressing the trade-offs present, our
algorithm identifies the pivot node. The pivot node serves
to separate the part of the relevant network that contains
the trade-offs that have given rise to the ambiguous sign
for the node of interest, from the part that does not con-

UNCERTAINTY IN ARTIFICIAL INTELLIGENCE PROCEEDINGS 2000

520

tain these trade-offs. The pivot node will allow for further
focusing. We recall that the pivot node is a node with an
ambiguous node sign, for which every possible unambigu­
ous sign would uniquely determine an unambiguous sign
for the node of interest. We define the concept of pivot
node more formally.

Let Q
(G, � ) be a relevant qualitative
probabilistic network; let 0 be the set of previously ob­
served nodes, let E be the newly observed node, and let I
be the network's node of interest, as before. The pivot node
for I and E is a node P E V (G) such that

Definition 2

•

Sb(E, P)

•

Sb (P, I)

•

=

E
E

� with o

=

'?';

� with <5' =/:- '?';and

there does not exist a node P' with the above prop­
erties that resides on a chain from E to P that is not
blocked by 0.

The pivot node in a relevant qualitative probabilistic net­
work has various convenient properties. Before discussing
these properties, we briefly review the concept of an ar­
ticulation node from graph theory. In a digraph, an ar­
ticulation node is a node that upon removal along with
its incident arcs, makes the digraph fall apart into vari­
ous separate components. In the digraph of our example
network, as shown in Figure 2, the articulation nodes are
the nodes C, D, H, I, and L; for the relevant network, de­
picted in Figure 4, node C is the only articulation node,
however. Articulation nodes are identified using a depth­
first search algorithm; for details, we refer the reader to
[Cormen et al., 1990]. Theorems 1 and 2 now state impor­
tant properties of a pivot node that allow for its identifica­
tion.
Theorem 1

Theorem 2 Let Q
(G, � ) be a relevant qualitative
probabilistic network; let E and I be as before. The pivot
node for I and E is unique.
=

Proof

(sketch). From Definition 1 we have that the rele­
vant network consists of only nodes that reside on an un­
blocked chain from the newly observed node E to the node
of interest I. From the definition of articulation node, we
further have that every such chain must include all articula­
tion nodes in the relevant network. In fact, every reasoning
chain from E to I visits the articulation nodes in the same
order. From Definition 2 we have that no two pivot nodes
can reside on the same unblocked chain to the node of in­
terest. We conclude that the pivot node is unique. 0

From the proof of Theorem 2 we have that the articula­
tion nodes in a relevant network allow a total ordering. We
number the articulation nodes, together with the node of in­
terest I, from I, for the node closest to the newly observed
node, to m, for the node of interest. The pivot node now
is the node with the lowest ordering number for which an
unambiguous sign would uniquely determine an unambigu­
ous sign for the node of interest. To identify the pivot node,
our algorithm starts with investigating the articulation node
closest to the node of interest; this node is numbered m - 1.
The algorithm investigates whether an unambiguous sign
for this candidate pivot node would result in an unambigu­
ous sign for the node of interest upon sign propagation. By
propagating a '+' from the candidate pivot node to the node
of interest I, the node sign resulting for I is the sign of the
net influence of the candidate pivot node on I. If this sign is
ambiguous, then the node of interest itself is the pivot node.
Otherwise, the algorithm proceeds by investigating the ar­
ticulation node numbered m 2, and so on. The algorithm
is summarised in pseudocode in Figure 8.
-

function ComputePivot(Q):

candidates+- {I} U FindArticulationNodes(G);
order the nodes from candidates from 1 to m;
return FindPivot(m- 1);

Let Q
(G, � ) be a relevant qualitative
probabilistic network; let E be the newly observed node
and let I be the node of interest. The pivot node for I and
E is either the node of interest I or an articulation node in
=

function FindPivot(i): pivot

G.

PropagateSign(node i,node i,'+')
if sign[node i + 1]
'?'
then return node i + 1;
else FindPivot(i
1)

Proof (sketch).

By definition we have that every possible
unambiguous node sign for the pivot node determines an
unambiguous sign for the node of interest I. It will be ev­
ident that node I itself satisfies this property. Either the
node of interest I or another node on an unblocked chain
from E to I, therefore, is the pivot node. Now, suppose
that node I is not the pivot node. As a sign for the pivot
node uniquely determines the sign for I, we conclude that
all influences exerted upon I must traverse the pivot node.
Every unblocked chain from E to I, therefore, must include
the pivot node. As a consequence, removing the pivot node
along with its incident arcs from the relevant network will
cause the network to fall apart into separate components.
We conclude that the pivot node is an articulation node. 0

pivot

=

-

Figure 8: The Algorithm for Computing the Pivot Node.
4.3

CONSTRUCTING RESULTS

From its definition, we have that there must be two or more
different reasoning chains in the relevant network from the
newly observed node to the pivot node; the net influences
along these reasoning chains are conflicting or ambiguous.
Our algorithm focuses on the ambiguity at the pivot node
and identifies the information that would serve to resolve
it. For this purpose, the algorithm zooms in on the part

UNCERTAINTY IN ARTIFICIAL INTELLIGENCE PROCEEDINGS 2000

of the relevant network between the newly observed node
and the pivot node; we call this part the pruned relevant
network. Note that the pruned relevant network is readily
computed by exploiting the property that the pivot node is
an articulation node. From the pruned relevant network, the
algorithm first selects the so-called candidate resolvers.
Definition 3 Let Q
(G, �) be a relevant qualitative
probabilistic network; let E be the newly observed node
and let I be the network's node of interest. Let P be the
pivot node for I and E. Now, let Qpru
(G', �1) be the
pruned relevant network for P. A candidate resolver for P
is a node Ri E V(G') , Ri =f. P, such that
=

where j8j once again is used to denote the strength of the
sign 8. We would like to note that as, in general, the resolu­
tion frontier includes a small number of nodes, the number
of signs to be computed for the pivot node is limited. In ad­
dition, we note that the process of constructing informative
results can be repeated recursively for the nodes in the pivot
node's resolution frontier, until the newly observed node is
reached. The basic algorithm is summarised in pseudocode
in Figure 9.
procedure ConstructResults(Q,pivot):

=

Ri

•

sign[Ri] ='?'and in-degree[Ri J 2: 2.

=

Qpru +- ComputePrunedNetwork(Q,pivot);
candidates +- ComputeCandidates(Qpru,pivot);
output ComputeResults(Qpru,pivot,candidates)

E, or

•

function

=

From among the candidate resolvers in the pruned relevant
network, our algorithm now constructs the resolution fron­
tier. We recall that the resolution frontier is a minimal set of
nodes for which unambiguous node signs would uniquely
determine the signs of the separate influences on the pivot
node.

function ComputeFrontier(pivotfrontier,
candidates): frontier
for all Vi

such that (Vi,pivot) or (pivot, Vi)
on a reasoning chain from E
do if Vi E candidates
thenfrontier +-frontier U {Vi}
else ComputeFrontier(Vi Jrontier,candidates)

=

The resolution frontier can be constructed by recursively
traversing the various reasoning chains from the pivot node
back to the observed node E and checking whether the
nodes visited are candidate resolvers.
Once the resolution frontier has been identified from the
pruned relevant network, the algorithm constructs a (con­
ditional) sign for the pivot node in terms of signs for the
nodes from the frontier. Let F be the resolution frontier
for the pivot node P. For each resolver Ri E F, let s;,
j 2: 1, denote the signs of the various different reasoning
chains from Ri to the pivot node. For each combination of
node signs sign[Ri], Ri E F, the sign of the pivot node is
computed to be
if

I EB(sign[R;]®s;

)=+

I EB(sign[R;]®s; )
then sign[PJ

=

=-

+,

( sign[Ri]

l8l

s}) 12:

( sign[Ri]

l8l

s}) I

else sign[P]

=

-

(I)

ComputeResults(Qpru.pivot,candidates):

frontier +- ComputeFrontier(pivot, 0,candidates);
for all Ri E frontier
do determines; , j 2 1;
for all R; Efrontier and sign[R;]
+,­
do return inequality (1);

The candidate resolvers for the pivot node are easily iden­
tified from the pruned relevant network.

Definition 4 Let Q
(G, �) be a pruned relevant quali­
tative probabilistic network; let E and I be as before. Let
P be the pivot node for I and E, and let R be the set of
candidate resolvers for P, as defined in Definition 3. The
resolution frontier F for P is the maximal subset of R such
that for each candidate resolver Ri E F there exists at
least one unblocked chain from E via Ri to P such that no
node Rj E R resides on the subchain from Ri to P.

521

Figure 9: The Algorithm for Constructing Results.
To conclude, we would like to note that for computing in­
formative results for a relevant network's pivot node, the
pruned network can be even further restricted. To this end,
a so-called boundary node can be identified for the newly
observed node. The boundary node is the articulation node
closest to the node of interest that has an unambiguous node
sign after propagation of the observation entered. Con­
structing results can then focus on the part of the relevant
network between the pivot node and the boundary node.
Moreover, if the thus pruned network includes many artic­
ulation nodes, it may very well be that trade-offs exist be­
tween the articulation nodes numbered k 1 and k, but not
between k and k + 1. Distinguishing between these com­
ponents is straightforward and allows for further focusing
on the actual trade-offs involved in inference.
-

5

CONCLUSIONS

We have presented a new algorithm for dealing with trade­
offs in qualitative probabilistic networks. Rather than re­
solve trade-offs by providing for a finer level of representa­
tion detail, our algorithm identifies from a qualitative prob­
abilistic network the information that would serve to re­
solve the trade-offs present. For this purpose, the algorithm
zooms in on the part of the network where the actual trade­
offs reside and identifies the pivot node for the node of in-

UNCERTAINTY IN ARTIFICIAL INTELLIGENCE PROCEEDINGS 2000

522

terest. The sign of the pivot node uniquely determines the
sign of the node of interest. For the pivot node, a more
informative result than ambiguity is constructed in terms
of values for the node's resolvers and the relative strengths
of the influences upon it. This process of constructing in­
formative results can be repeated recursively for the pivot
node's resolvers.
As we have already mentioned in our introduction, we be­
lieve that qualitative probabilistic networks can play an im­
portant role in the construction of quantitative networks for
real-life application domains, as well as for explanation of
their reasoning processes. For the purpose of explanation,
qualitative probabilistic networks have been proposed be­
fore. The concept of pivot node for zooming in on trade­
offs and constructing insightful results for a network's node
of interest is a very powerful concept to enable explanation
of complex reasoning processes in quantitative probabilis­
tic networks.
Acknowledgments

This work was partially supported by the EPSRC under
grant GR/L84117 and a Ph.D. studentship.



We propose a formal framework for intelligent
systems which can reason about scientific do­
mains, in particular about the carcinogenicity
of chemicals, and we study its properties. Our
framework is grounded in a philosophy of sci­
entific enquiry and discourse, and uses a model
of dialectical argumentation. The formalism en­
ables representation of scientific uncertainty and
conflict in a manner suitable for qualitative rea­
soning about the domain.

1

INTRODUCTION

We seek to build intelligent systems which can reason au­
tonomously about the risk of carcinogenicity of chemicals,
drawing on whatever theoretical or experimental evidence
is available. In earlier work (McBurney & Parsons 1999),
reviewing the literature on methods of carcinogen risk as­
sessment, we listed the different types of evidence adduced
to support these claims, which may be in the form of: ex­
perimental results on tissue cultures, animals or human epi­
demiological studies; analytical comparisons with known
carcinogens; or explication of biomedical causal pathways.
Evidence from these different sources may conflict, and
carcinogen risk assessment usually involves the compar­
ison and resolution of multiple evidence (E.P.A. U.S. A
1986; Graham, Green, & Roberts 1988). In representing
this domain, it therefore seems appropriate to use some
form of argumentation (so that the reasons for claims can
be represented in association with the claims themselves),
and within a dialectical framework (so that cases for and
against a particular claim can be compared). In particular,
dialectical argumentation enables the representation of un­
certainty in the underlying scientific knowledge base. This
paper presents such a dialectical formalism for an intelli­
gent system, which we termed a Risk Agora in our earlier
work. We begin by examining the nature of scientific dis­
course.

2

2.1

SCIENTIFIC DISCOURSE

A MODEL OF SCIENTIFIC ENQUIRY

Our chosen application domain is a scientific one. To repre­
sent this domain, therefore, we seek to ground our formal­
ism in a philosophical model of scientific enquiry. Firstly,
we require a theory of the nature of modem science. Fol­
lowing Pera (1994), we view the enterprise of science as
a three-person dialogue, involving a scientific investiga­
tor, Nature and a skeptical scientific community. In Pera's
model, the investigator proposes theoretical explanations of
scientific phenomena and undertakes scientific experiments
to test these. The experiments lead to "replies" from Na­
ture in the form of experimental evidence. However, Na­
ture's responses are not given directly or in a pure form,
but are mediated through the third participant, the scien­
tific community, which interprets the evidence, undertakes
a debate as to its meaning and implications, and eventually
decides in favor or against proposed theoretical explana­
tions. The consequence of this model for our formalism is
that we provide Nature with a formal role, but manifest it
through those of the other participants.
But Pera's model of modem science as a dialogue game
could apply to many other human dialogues, most of which
do not share science's success in explaining and predict­
ing natural phenomena. Our model of science therefore
requires an explanation of its success. Some philosophers
of science believe this is due to the application of univer­
sal principles of assessment of proposed scientific theo­
ries, such as the falsificationism of Popper or the confir­
mationism of Camap. However, we do not share these
views, instead believing, with Feyerabend (1993), that the
standards of assessment used by any scientific community
are domain-, context- and time-dependent. This view, that
there are neither universal nor objective standards by which
scientific theories can be judged, was called "epistemolog­
ical anarchism" by Lakatos (Lakatos & Feyerabend 1999).
Instead of universal principles of assessment of theories,
we believe science's success arises in part from applying
two normative principles of conduct: firstly, that every the-

UNCERTAINTY IN ARTIFICIAL INTELLIGENCE PROCEEDINGS 2000

372

oretical explanation proposed by a scientific investigator is
contestable by anyone; and secondly, that every theoretical
explanation adopted by a scientific community is defeasi­
ble. In other words, all scientific theories, no matter how
compelling, are always tentative, being held only until bet­
ter explanations are found, and anyone may propose these.1
To build an intelligent system based on these principles,
we therefore require a (normative) model of scientific
discourse which enables contestation and defeasibility of
claims. Our model has several components. At the high­
est level, we are attempting to model a discourse between
reasonable, consenting scientists, who accept or reject ar­
guments only on the basis of their relative force. An in­
fluential model for debates of this type is the philosophy
of Discourse Ethics developed by Habermas ( 1991) for de­
bates in ethical and moral domains. Our formalism there­
fore draws on Habermas, in particular his rules of discourse
first fully articulated by Alexy (1990), and these form the
basis of the desired properties of the Agora formalism pre­
sented later in this section.2
Next, within this structure, we wish to be able to model
dialogues in which different participants variously posit,
assert, contest, justify, qualify and retract claims. To rep­
resent such activity requires a model of an argument, and
we use Toulmin's (1958) model, within a dialectical frame­
work. To embody our belief in epistemological anarchism,
we permit participants to contest any component of a sci­
entific argument: its premises; its rules of inference (Toul­
min 's "warrants"); its degrees of support (his "modalities");
and its consequences. We believe this is exactly what real
scientists do when confronted with new theoretical expla­
nations of natural phenomena (Feyerabend 1993). When
a scientific claim is thus contested, its proponent may re­
spond, not only by retracting it, but by qualifying it in some
way, perhaps reducing its scope of applicability. Naess
( 1966) called this process "precizating", and we seek to
enable such responses in the system. We thus ground our
formalism for the Agora in a model of scientific discourse
as dialectical argumentation.3
2.2 DESIRED AGORA PROPERTIES

As mentioned, we desire our Agora formalism to satisfy the
rules for a reasoned discourse proposed by Alexy (1990),
which are listed here. In restating these, we have modi­
fied and re-ordered them slightly, and have ignored rules
which deal specifically with discussion of ethical matters.
Also, because our formalism is intended for debate regard­
ing only one chemical at a time, we have ignored Alexy's
1

These two principles are each necessary to explain science's

success, but not sufficient.
2 Alexy's

rules have some similarity with Grice's (1975) Max­

ims for Conversation.
3
Further details of our philosophy of science are contained in

(McBurney & Parsons 2000b).

rules regarding the relevance of utterances. We have also
added a property concerning precization.
Pl Anyone may participate in the Agora, and they may
execute dialogue moves at any time, subject only to
move-specific conditions (defined below).
P2 Participation entails acceptance of the semantics for the
logical language used, and of the associated modality
(degrees of support) dictionaries.
P3 Any participant may assert any claim or consequence
of a claim, but may do so only when they have a
grounded argument for the claim (respectively, a con­
sequential argument from the claim).
P4 Any participant may question or challenge any claim
or any consequence of a claim.
PS Any participant who asserts a claim (respectively,
a consequence of a claim) must provide a valued
grounded argument for that claim (respectively, a val­
ued consequential argument from the claim) if queried
or challenged by another participant.
P6 Any participant may question or challenge the grounds,
the rules of inference or the modalities for any claim.
P7 Whenever a participant asserts a valued grounded argu­
ment for a claim (or a valued consequential argument
from a claim), any other participant may assert a val­
ued grounded argument (respectively, a valued conse­
quential argument) for the same claim with different
dictionary values.
PS A participant who has provided a grounded argument
for a claim which has been challenged should be able
to respond by qualifying (precizating) the original
claim or argument.
P9 Any participant who provides a grounded argument
for, or a consequential argument from, a claim is
not required to provide further defence if no counter­
arguments are provided by other participants.
PlO No participant may contradict him or herself.
3

3.1

THE RISK AGORA FORMALISM

PRELIMINARY DEFINITIONS

We begin by assuming the system is intended to represent
debate regarding the carcinogenicity of a specific chemi­
cal, and that statements concerning this can be expressed
in a propositional language £, whose well-formed formu­
lae (wffs) we denote by lower-case Greek letters. Subsets
of £ (i.e. sets of wffs) are denoted by upper-case Greek
letters, and £ is assumed closed under the usual connec­
tives. We assume multiple modes of inference (warrants)

373

UNCERTAINTY IN ARTIFICIAL INTELLIGENCE PROCEEDINGS 2000

are possible, these being denoted by 1- i. These may include
non-deductive modes of reasoning, and we make no pre­
sumptions regarding their validity in any truth model. We
assume a finite set of debate participants, denoted by Pi.
who are permitted to introduce new wffs and new modes of
inference at any time. We denote Nature, in its role in the
debate, by PN.
Definition 1: A grounded argument for a claim 0, de­
noted A(-+ 0), is a 3-tuple (G,R,O), where G =
(0o,01,81,02,. . . ,0n-2,On-1,0n-1) is an ordered se­
quence of wffs()i and possibly -empty sets of wffs 0i, with
n � 1 and withR = (h, h, . . . ,1-n) an ordered sequence
ofinference rules such that:

In other words, each ()k (k = 1, ... , n 1) is derived from
the preceding wff ()k_1 and set of wffs 0k-1 as a result of
the application of the k-th rule of inference, 1- k. The rules
of inference in any argument may be non-distinct. We call
the set {Ok-1} u 0k_1 the grounds(or premises) for Ok.
-

Definition 2: A consequential argument from a claim (),
denoted A(O --+ ), is a 3-tuple (0,R,C), where C =
(0o,01,81,02,. . . ,0n-2,On-1,0n-1,On) is an ordered
sequence of wffs()i and possibly -empty sets of wffs0i, with
n � 1, and with R = (l-1,h, . . . ,1-n) an ordered se­
quence ofinference rules such that:

On-1, 0n-1 1-n On.
In other words, the wffs ()k in C are derivations from ()
arising from the successive application of the rules of in­
ference in R, and we call each ()k in C a consequence of
0.
In order that participants may effectively state and con­
test degrees of commitment to claims, we require a com­
mon dictionary of degrees of commitment or support (what
Toulrnin called "modalities"). Our formalism will support
any agreed dictionary, whether quantitative (such as a set of
probability values or belief measures) or qualitative (such
as non-numeric symbols or linguistic qualifiers), provided
there is a partial order on its elements. We define dictionar­
ies for modalities for claims, grounds, consequences and
rules of inference.

Definition 3: Four modality dictionaries are defined as fol­
lows, each being a (possibly infinite) set of elements having
a partial order. Theclaims dictionary is denoted by Vc, the
grounds dictionary by Va, the consequences dictionary by
VQ, and the inference dictionary by VI.
Because claims, grounds and consequences are all elements
of the same language .C, two or more of the dictionaries
Vc, Va and VQ may be the same. However, a distinct
dictionary will generally be required for VI. 4 Because of
our belief in epistemological anarchism, we do not specify
rules of assignment of dictionary labels by participants in
the Agora. In particular, the labels assigned to the conclu­
sions and consequences of arguments are not constrained
by those assigned to premises or rules of inference.
Example I: The generic argumentation dictionary defined
for assessment of risk by (Krause et al. 1998) is an exam­
ple of a linguistic dictionary for statements about claims,
grounds or consequences, comprising the set: {Certain,
Confirmed, Probable, Plausible, Supported, Open}. The
elements of this dictionary are listed in descending order,
with each successive labelindicating a weaker beliefin the
claim.
Example 2: Two examples of Inference Dictionaries are
VI= {Valid, Invalid} andVI= { Acceptable, Sometimes
Acceptable, Open, Not Acceptable}.
Definition 4: A valued grounded argument for a claim
(), denoted A(-+ O,D), is a 4-tuple (G,R,O,D), where
(G,R,0) is a grounded argument for () and D
(do,d1,. . . ,dn-1,do,r1,r2,... ,rn) is an ordered se­
quence of labels and vectors of labels, with eachdi a vector
of dictionary labelsfrom Vc (fori = 0, . . , n 1), with
do E Vc and with ri E VI (fori = 1, . . . , n). Each
vector di comprises those values of theClaimsDictionary
assigned to grounds{()i} u 0i, the elementdo is that value
of the Claims Dictionary assigned to() and each element
ri is that value of the InferenceDictionary assigned to 1- i.
A valued consequential argument from a claim 0, denoted
A(() --+,D), is defined similarly .
.

3.2

-

DISCOURSE RULES

We next define the rules for discourse participants, building
on the definitions above. Moves are denoted by 2-ary or
3-ary functions of the form name(Pi: . ), where the first
argument denotes the participant executing the move. If the
move responds to an earlier move by another participant,
that earlier move is the second argument. Arguments are
separated by colons. In Section 4, we will show that these
rules give operational effect to the Desired Properties.

4

In (McBurney & Parsons 2000c), we model degrees of ac­

ceptability of inference rules.

UNCERTAINTY IN ARTIFICIAL INTELLIGENCE PROCEEDINGS 2000

374

Rule 1: Query and Assertion Moves
1.1 Pose Claim: Any participant Pi at any time may
move:
pose(Pi :---+ (}?)

which asks the Agora if there is a grounded argument
for e.

1.8 Assert Consequence: Similarly to Assert Claim, a
participant may move:

asserLcons(Pi : (0,¢, d¢))
where ¢ is a consequence of 0.
1.9 Query Consequence: Similarly to Query Claim, a
participant may move:

1.2 Propose Claim: Any participant Pi at any time may
propose a claim with move:

propose(Pi : ((}, de))
where(} E £ and de E Vc, which informs the Agora
that Pihas a valued grounded argument for(}, and has
assigned it a modality of de.
1.3 Assert Claim: Any participant Pi at any time may
assert a claim with move:

assert(Pi : ((},de))
where (} is a wff and de E Vc, which informs the
Agora that Pi has a valued grounded argument for (},
which she believes is compelling.
1.4 Query Claim: W henever a propose or assert move
relating to ((},de) has been made by participant Pi.
any other participant Pi may move:

query(Pj : propose(Pi : (0,de)))
or
query(Pj : assert(Pi: (O,de))).
These ask participant Pi to provide her valued
grounded argument for 0, which she must provide im­
mediately with move:
show_arg(Pi : A(---+ 0,D)).
1.5 Show Grounded Argument: Any participant Pi may
at any time provide a valued grounded argument for 0
with the move:

query_cons(Pj : propose(Pi: (0,¢, d¢))).
1.10 Show Consequential Argument: Any participant Pi
may at any time provide a valued consequential argu­
ment from 0 with the move:

show_cons(Pi : A(O ---+,D)).
1.11 Propose Mode of Inference: Any participant Pi at
any time may move:

where I-t is a mode of inference and rt E V1. This
move informs the community that participant Pi be­
lieves that I-t is a mode of inference of strength at least
Tt.
Note that the query and assertions rules are not symmet­
ric between grounded and consequential arguments; partic­
ipants may only propose or assert claims for which they
have grounded arguments, but they need not necessarily
have considered the consequences of these claims. Next,
we explicitly define the ContestClaimrule, with other con­
testation rules being defined similarly. For brevity in the
following, we sometimes write A for A(---+ (},D).
Rule 2: Contestation Moves
2.1 Contest Claim: W henever proposeor assert relating
to (0,de) has been moved by participant Pi. any other
participant Pi may contest this by moving:

contest(Pj : propose(Pi : (B, de)))

show_arg(Pi: A(-+ O,D)).
1.6 Pose Consequence: A participant Pk may at any time
move:
pose_cons(Pk : () ---+?)

which asks the Agora if there is a consequential argu­
ment from 0.
1.7 Propose Consequence: Similarly to ProposeClaim, a
participant may move:

propose_cons(Pi : (0,¢, d¢))
where ¢ is a consequence of 0.

or
contest(Pj :assert(Pi : (0, de))).
If any participant Pk subsequently queries this contes­
tation with:
query(Pk : contest(Pj : propose(Pi : (0,de))))
(or likewise for assert), participant Pi must respond
immediately, either with an assignment of an alterna­
tive modality d0 for claim 0, thus:
propose(Pi : (0,d0))

UNCERTAINTY IN ARTIFICIAL INTELLIGENCE PROCEEDINGS 2000

or
assert(Pj : (B,d�))
(where d� =/: do), or with a stronger assertion of the
negation of B, thus:
propose(Pj : (•B,d�))

3.4 Accept Mode of Inference: Similarly to accept.prop:

accepLinf(Pj : propose_inf(Pi: (f-t,rt))).
3.5 Accept Consequence: Similarly to accept.prop:

accepU:ons(Pj : show_cons(Pi : A(B --+,D))).

or
assert(Pj : (•B,d�))
(where d� >do).
2.2 Contest Ground:

375

3.6 Precizate Claim: Any participant Pi who proposes or
asserts a claim for (}, and follows this with a demon­
stration of a valued grounded argument for(} by:

show..arg(Pi : A(--+ B,D))

contesLground(Pj :show...arg(Pi : A : (Bt,do,)).

may subsequently qualify her argument with:

2.3 Contest Inference:

prec(Pi : show...arg(Pi : A(--+ B,D)): A' (--+ B,D'))

contesLinf(Pj : show...arg(Pi : A : f-t)).

where A' (--+ (}, D') is an argument for(} identical with
A(--+ B,D) except that: (a) it begins from ground <I> U
80 instead of 00, where <I> is not equal to { B} nor to
any ground of(}, and (b) D' may be different to D.

2.4 Contest Modality:

contest.mod(Pj : show...arg(Pi : A(--+ B,D))).
2.5 Contest Consequence:

contesLcons(Pj : show_cons(Pi : A: (Bt,do,))).

3.7 Retract Claim: Any participant Pi who asserts:

assert(Pi: (B,do))
Rule 3: Participant Resolution Moves
3.1 Accept Proposed Claim: Whenever a claim has been
proposed by Piand its grounds demonstrated by moving:
show...arg(Pi : A(--+ B,D)),

any other participant P1 may declare that they accept
the proposed claim, with move:
accept_prop(Pj : show...arg(Pi : A(--+ B,D))).

may at any time subsequently withdraw the claim by:
retract(Pi: assert(Pi: (B,do))).
Likewise, for those claims by others accepted by Pi.
3.8 No contradiction: Any participant Pi who asserts (or
accepts an assertion for) (} may not at any time subse­
quently assert (or accept an assertion for) -.(}, unless
they have in the interim moved:

This move is identical with the sequence:

retract(Pi : assert(Pi : ((}, do)))

propose(Pj : ((}, do))

(or, respectively, its equivalent for accepted claims).

show..arg(Pj : A(--+ B,D)).
3.2 Accept Asserted Claim: Similarly to accept.prop:

accept..assert(Pj : show...arg(Pi : A(--+ B,D))).
3.3 Change Modalities: Any participant Piwho proposes
or asserts a claim for(}, and follows this with a demon­
stration of a valued grounded argument for(} by moving:
show...arg(Pi : A(--+ B,D)),

may subsequently revise her assignment of modalities
with a later move of:
show..arg(Pi : A(--+ B,D')),
where D' =/: D. Likewise, declarations of modal be­
liefs expressed in other moves (e.g. in accept..assert)
may also be revised by subsequently executing the
same move with a different set of dictionary values.

3.3

DIALOGUE RULES

Definition 5: A Dialogue is a finite sequence of discourse
moves by participantsin theAgora, in accordance with the
rules above.
As in (Hamblin 1971; Walton & Krabbe 1995; Amgoud,
Maudet, & Parsons 2000), we define sets called Commit­
ment Stores which contain the proposals and assertions
made by participants, both individually and for the Agora
as a community, and track these as they change.
Definition 6: The commitment store of player Pi,
i = 1, 2, .., denoted CS(Pi), is a possibly empty set
{(B,do) I (} E £, do E Vc}. Each do is the claim dic­
tionary value assigned by Pi toB.
.

The values in participants' stores are updated by the fol­
lowing rule:

UNCERTAINTY IN ARTIFICIAL INTELLIGENCE PROCEEDINGS 2000

376

Rule 4: Participant Commitment Store Update: When­
ever participantPi executes the moves

Rule 5: Nature's Modalities: The modality do,N of Na­
ture for the claim () is assigned as follows:

propose(Pi:((),do)),

•

If () is a wff for which no grounded argument has yet
been provided by a participant, then do,N is assigned
the value Open.

•

If() is a wff for which at least one grounded argument
has been provided by a participant, then do,N is as­
signed the value Supported.

•

If() is a wff for which a grounded and consistent argu­
ment has been provided by a participant, then do,Nis
assigned the value Plausible.

•

If () is a wff for which a grounded and consistent ar­
gument has been provided by a participant, and for
which no rebutting arguments have been provided,
then do,Nis assigned the value Probable.

•

If () is a wff for which a grounded and consistent ar­
gument has been provided by a participant, and for
which neither rebutting nor undercutting arguments
have been provided by participants, then do,N is as­
signed the value Confirmed.

•

If () is a logical tautology, then do,N is assigned the
value Certain.

accept_prop(Pi: propose(Pj:((),do))),
assert(Pi: (e,do)),
accept..assert(Pi: assert(Pj :((),do)))
or their equivalents, then the tuple ((),do) is inserted into
CS (Pi). Whenever participant Pi executes a retraction
move for ((), do), the tuple ((), do)is removed fromCS (Pi).
Similarly, whenever Piexecutes a Change Modality move
for ((), do), the value of ((), do)in C S (P i)is revised.
We next define an analogous concept for Nature, with
claims inserted into Nature's Commitment Store on the ba­
sis of the debate at that point in the Agora. This could be
achieved in a number of ways. For example, a skeptical
community could define Nature's modality for a claim() to
be the minimum claim modality assigned by any of those
Participants claiming or supporting (). A credulous com­
munity could instead assign to Nature the maximum claim
modality assigned by any of the participants to e. Varia­
tions on these approaches could utilize majority opinion or
weighted voting schemes.
Because we wish to model dialectical discourse, we have
instead chosen to assign Nature's modalities on the basis
of the existence of arguments for and against the claim.
To do this, we draw on the generic argumentation dictio­
nary for debates about carcinogenicity of chemicals pre­
sented in (Krause et al. 1998), which is based on Toulmin 's
(1958) schema. We begin by defining certain relationships
between arguments and then the Claims Dictionary for Na­
ture.
Definition 7: An argument A(-t () ) = (G, R,() ) is con­
sistent if G = (eo,()1, e1,()2, ..., en-2, ()n-1, en-d is
consistent, thatis fi there do not exist a, (3 E eo U {()1 } U
e1 u {()2} u
u en-1 such that·f3 is a consequence of
0 0 0

a.

Definition 8: Let A(-t ())
(G,R,()) and B(-t
¢>)
(H, S, ¢>) be two arguments, where G
(eo,e1, e1, ()2, . . . ,()n-1, en-d· We say thatB(-t ¢>)re­
buts A(-t ()) if¢>= () We say that B(-t ¢>) undercuts
A(-t () )if,for somea E eou{el}ue1u{e2}u...uen-1>
a= •¢>.
=

=

...,

_

Definition 9: The claims dictionary for Nature is the set
Vc,N = {Certain, Confirmed, Probable, Plausible, Sup­
ported, Open}.
Definition 10: The commitment store of Nature, denoted
CS(PN), is a non-empty set{(e,do,N) I () E £, do,N E
Vc,N}. Eachdo,N is the claim modality assigned by the
Agora community on Nature's behalf to(), in accordance
with the next two rules.

Rule 6: Nature Commitment Store Update: The entries
in CS(PN) are updated after each legal move by Agora
participants.
3.4

ARCHITECTURE AND USER INTERFACE

We anticipate the Risk Agora system being used to rep­
resent a completed or on-going scientific debate, but not in
real-time. Once instantiated with a specific knowledge base
in this way, the Agora could be used for a number of differ­
ent purposes, which led us (McBurney & Parsons 1999), to
propose a layered architecture for the Agora, corresponding
to these different functions. The main purposes to be ful­
filled are: (a) automated reasoning to find arguments for,
and the consequences of, particular claims; (b) compari­
son of the various arguments for and against a claim; and
(c) development of an overall case for a claim, coherently
combining all the arguments for and against it.
4

AGORA PROPERTIES

The rules defined in the previous section were intended to
operationalize the desired Agora properties of Section 2.2.
We now verify that this is indeed the case.
Theorem I: The Agora sy stem defined in Section 3 has
PropertiesP1 throughP10.
Proof. This is straightforward, from the definitions of the

UNCERTAINTY IN ARTIFICIAL INTELLIGENCE PROCEEDINGS 2000

permitted moves. Thus, Properties P l and P2 are fulfilled
through the overall system design; Property P3 by Rules
1.1-1.3 and 1.6-1.8; Property P4 by Rules 1.4, 1.9, 2.1 and
2.5; Property P5 by Rules 1.2, 1.3, 1.5, 1.7, 1.8 and 1.10;
Property P6 by Rules 2.2-2.4; Property P7 by Rules 3.13.5; Property P8 by Rule 3.6; Property P9 by Rules 1 and
0
2; and Property P lO by Rule 3.8.
Moreover, we can use the definition of the claim modalities
for Nature provided by Rule 5 to construct a valuation func­
tion on wffs and to define a notion of "proof" of claims, as
follows.
Definition 11: Natural valuation is afunction v N defined
from the set of wffs ofC to the set{0, 1 }, such thatv N (B)
1 precisely whendo,N = Confirmed; otherwise, vN(B) =
0.
=

Definition 12: A provisional proof for a claimB is a
grounded and consistent argument forB for which neither
rebuttal nor undercutting arguments exist.
Our belief in the defeasibility of all scientific claims leads
us to use the term "provisional proof" rather than "proof."
Likewise, we can think of a natural valuation equal to 1 as
signifying "Currently Accepted as True" (or "Defeasibly
True") and 0 as "Not Currently Accepted as True." Our
definition of natural valuation thus says that a claim is de­
feasibly true iff there are no arguments attacking it. We
could readily define additional valuation functions which
capture degrees of conviction regarding the truth of claims,
mapping, for instance, to Probable or to Plausible. With
the definitions above, we can now prove soundness of pro­
visional proofs in the Agora, with respect to the natural
valuation function.
Theorem 2: With the notion of provisional proof, theAgora
is consistent and complete with respect to theNatural Val­
uationFunctionvN, provided that all grounded arguments
for claims are eventually asserted by someParticipant.
Proof. Consistency here says that all claims B for which
there exists a provisional proof are also assigned a valu­
ation of 1 by the function VN. Completeness says, con­
versely, that all claims B which are assigned a valuation of
1 by v N also have a provisional proof. Both of these follow
from our definitions of v N and of provisional proof, unless
a consistent grounded argument for a claim B exists but is
0
not asserted by any Participant.
The model of science we have adopted asserts that scien­
tific claims are regarded as "defeasibly true" only when
the relevant scientific community agrees to so regard them.
(After all, even if a transcendent truth exists, science has
no privileged means of accessing it.) Our definition of nat­
ural valuation is in effect a proxy for the scientific commu­
nity's opinion on the truth of a claim. Accordingly, The­
orem 2 says that the provisional proof procedure neither
under-generates nor over-generates defeasibly true claims,

377

provided all grounded arguments for claims are eventually
asserted.
5

EXAMPLE

To illustrate these ideas we present a simple and hypothet­
ical example of an Agora debate. In a real debate, partic­
ipants would be free to introduce supporting evidence and
modes of inference at any time. For reasons of space, in this
example we first list the statements and modes of inference
to be asserted, labeled K l through K4, and R l through R3,
respectively, about a chemical X:
Kl: X is produced by the human body naturally (i.e. it is
endogenous).
K2: X is endogenous in rats.
K3: An endogenous chemical is not carcinogenic.
K4: Bioassay experiments applying X to rats result in sig­
nificant carcinogenic effects.
Rl (And Introduction): Given a wff ¢ and a wff B, we
may infer the wff ( ¢ 1\ B).

R2 (Modus Ponens): Given a wff¢ and the wff (¢-+B),
we may infer the wff B.
R3: If a chemical is found to be carcinogenic in an ani­
mal species, then we may infer it to be carcinogenic
in humans.

We now give an example of an Agora dialogue concern­
ing the statement: X is carcinogenic to humans, which
we denote by ¢. The moves are numbered M l , M2, .. .,
in sequence, and for simplicity we assume the participants
are using the claims dictionary of Example 1, abbreviated
to {Cert, Conf, Prob, Plaus, Supp, Open}, and the in­
ference dictionary V1 = {Val, Inval} . Before any dis­
course move is made, Nature's modality for this claim is
dq, N = Open, as is its modality for •¢. Ignoring claims
about any other chemicals, we thus have at commencement
thatCS(PN) = {(¢,0pen),(• ¢, 0pen)}. Through the
dialogue, we show the contents of Nature's commitment
store as it changes, in steps numbered NCSO, NCS l , .. .
,

NCSO: CS(PN) ={(¢, Open), (• ¢, Open)}.
Ml: assert(P1 : (¢,Con!)).
M2: query(P2 : assert(P1 : (¢,Con!))).
M3: show....arg(P1 : (K4, R3, ¢,(Conf, Val,Con!))).
NCSl: CS(PN) ={(¢, Con!), (• ¢,Open)}.
M4: contest(P2 :assert(P1 : (¢, Con!))).

UNCERTAINTY IN ARTIFICIAL INTELLIGENCE PROCEEDINGS

378

M5: query(P3 :contest(P2 :assert(P1 :(¢;,Con!))))
M6: propose(P2 : (•¢;,Plaus)).
M7: query(P1 :propose(P2: ( •¢>, Plaus ))).
M8: show...nrg(P2 : ((Kl, K3), R2, •¢>,
(Conf,Prob, Val,Plaus))).
NCS2: CS( PN) = {(¢;,Plaus),(•¢;,Plaus)}.
M9: contest_ground(P4 :
show...nrg(P2:((Kl, K3), R2, •¢;,
(Conf,Prob, Val,Plaus)) : (K3,Prob))).
MlO: show...nrg(P4:((K2, K4), RI, -.K3,
(Conf,Con/, Val, Con!)) )
NCS3: CS( PN) = {( ¢>, Plaus),(•¢>,Plaus)}.

Observe that Participant P4 in Move MlO, by providing an
argument for -.K3, undercuts the argument presented for
¢> by Participant P2 in Move MS. We can also observe the
changes in the Natural Valuation of ¢; through the course
of this debate. At the start, we have VN(¢>)
0, which
changes to vN(¢) = 1 after Move M3, since then de,N =
Con/. However, after Move M8, de,N = Plaus, so once
again VN(¢>) = 0.
=

6

DISCUSSION

Characterization of scientific discourse as dialectical argu­
mentation is not new. Rescher ( 1977) claims to have been
the first to propose a dialectical framework for modeling
the progress of scientific inquiry, and Pera's (1994) work is
also a dialectical approach to science. Among argumen­
tation theorists, Freeman (1991) also discusses scientific
discourse in his study of argument structure. Both Carlson
(1983) and Walton and Krabbe (1995) aim to model generic
dialogues, but their focus is (respectively) on question-and­
answer and persuasion dialogues. In addition, neither for­
malism explicitly permits degrees of support for commit­
ments to be expressed, which our formalism does.
None of these works appears intended for encoding in in­
telligent systems. Within AI, intelligent systems for scien­
tific domains have used argumentation for some time (e.g.
Fox, Krause, & Ambler 1992). However, these applications
have typically involved monolectical rather than dialectical
argumentation. More recently, Haggith (1996) developed
a dialectical argumentation formalism and applied the re­
sulting system to a carcinogenicity debate. However, the
primary focus of her work was on knowledge representa­
tion in generic domains of conflict, and so her formalism
is not grounded in an explicit philosophy of science. The
work of Amgoud, Maudet, & Parsons (2000) is closest in
approach to that presented here (and we have drawn upon
their formalism), but it is focused on negotiation dialogues,

2000

agam m a generic context. Their formalism only permits
two participants, although this would be relatively easy to
amend. As with Haggith's system, their formalism does not
permit debate over the rules of inference used. Recent legal
argumentation systems, such as those of Verheij ( 1999), do
permit this.
Our formal definition of the Risk Agora enables contes­
tation and defeasibility of scientific claims. Our system
therefore operationalizes the two normative principles of
conduct for scientific discourses presented in Section 2.1.
We are currently exploring a number of refinements to the
Agora. Firstly, Rehg ( 1997) has demonstrated the ratio­
nality of incorporation of rhetorical devices (such as epi­
deictic speech and appeals to emotions) in dialectical argu­
ment and decision-making, and we seek a means to incor­
porate such devices in the Agora. This would not be novel:
the argumentation system of Reed ( 1998), for example, al­
lows for the modeling of rhetorical devices, although in a
monolectical context. Secondly, using the Agora in a de­
liberative context would require incorporation of values for
the projected consequences and the development of an ap­
propriate qualitative decision-theory, as in (Fox & Parsons
1998; Parsons & Green 1999).
We believe the Risk Agora has a number of potential bene­
fits. Firstly, by articulating precisely the arguments used to
assert carcinogenicity, gaps in knowledge and weaknesses
in arguments can be identified more readily. Such iden­
tification could be used to prioritize bio-medical research
efforts for the particular chemical. Secondly, by explor­
ing the logical consequences of claims, the Risk Agora can
serve a social maieutic function, making explicit knowl­
edge which may only be latent. Thirdly, once instantiated
with the details of a particular debate, the system could
be used for self-education by others outside the scientific
community concerned. Indeed, it could potentially form
the basis for the making of regulatory or societal deci­
sions on the issues in question (e.g. Should the chemical
be banned?) , and thereby give practical effect to notions
of deliberative democracy (McBurney & Parsons 2000a;
2000 In press). Finally, with argumentation increasingly
being used in the design of multi-agent systems (Parsons,
Sierra, & Jennings 1998), the formalism presented here
could readily be adapted for deliberative dialogues between
independent software agents.
Acknowledgments

This work was partly funded by the British EPSRC under
grant GRIL84117 and a PhD studentship. We also thank
the anonymous reviewers for their comments.

. Two solid phases of cyclohexane have been investigated over a
temperature range spanning 13 to 266 K on a powdered, perdeuterated sample using
neutron total scattering. Phase II has an ordered structure (C 2/c) that forms below
186 K. Between 186 and 280 K it exists as a plastic solid – phase I (Fm3m), where
the molecules are rotationally disordered about the lattice points of the face-centred
cubic cell. Data-dependent atomistic configurations that represent the ‘instantaneous’
crystal structure have been generated from the total scattering data using Reverse
Monte Carlo refinement. Analysis of local structure reveals that instantaneous
distortions in phase I resemble the average structure of phase II.

PACS numbers: 02.70.Uu, 61.05.fg, 64.60.Cn

Local structure correlations in cyclohexane

2

1. Introduction
Understanding the behaviour of matter in the solid state is crucial for the rational
development of compounds such as functional materials or pharmaceuticals where
intentional induction or prevention of a phase transition is key to the performance
of the compound [1, 2, 3]. One approach to understanding this behaviour is through
quantification of the relative stabilities of polymorphic crystals, or two structures either
side of a phase transition, in terms of interaction energies and/or thermodynamic
parameters [4, 5, 6, 7]. However by taking this approach, one aspect of phase behaviour
is overlooked – how the molecules interact locally. Average-structure models, such as
those obtained from a typical crystallographic refinement are useful for observing how
a material behaves over the duration of data collection, but they do not reveal how the
molecules interact at a local level, nor how they influence neighbouring molecules as the
substance approaches a phase transition.
Neutron total scattering presents an appealing approach for monitoring phase
transitions given its capability of simultaneously measuring both the average (crystal)
structure and the instantaneous local environment around each atom. With respect
to the solid state, the total scattering field has been mostly limited to extended
inorganic structures, such as strontium titanate [8], quartz [9], cristobalite [10] and
the Pb2 Ru2 O6.5 oxide pyrochlore [11]; there are comparatively few experiments that
focus on molecular systems and even fewer that aim to model the structure from the
scattering data. Molecular systems arguably present a greater challenge, given that
intermolecular interactions are much weaker than covalent bonds and so each molecule
and, by extension, each atom in a molecule is inherently more predisposed towards
occupying a wider range of positions. Whilst relatively simple molecular systems such as
SF6 [12] and CBr4 [13] have been studied, where orientational disorder in each of these
was reproduced in atomistic models through direct refinement against the scattering
data, molecules of increasing complexity are starting to be explored. Qualitative and
quantitative comparisons of the measured pair distribution functions from amorphous
and crystalline forms of carbamazepine and indomethacin have been performed, with
the intention of developing a method for ‘fingerprinting’ amorphous and nanocrystalline
pharmaceuticals [15, 14]. One of the challenges posed by large molecules is the difficulty
in distinguishing intra from intermolecular contacts between atoms of the same type
when they are separated by similar distances. A study of the ρ-terphenyl molecule
aimed to tackle this problem by identifying differences in pair distribution function peak
shapes to differentiate between intra and intermolecular correlations. This information
was used to make adjustments to an atomistic model so as to be consistent with the
experimental data [16]. To the best of our knowledge, this study of ρ-terphenyl is the
first ‘sizeable’ organic molecule to be studied using a combined total scattering/atomistic
modelling approach.
Cyclohexane, the focus of this present investigation, is an important molecular
system that has also been studied using neutron total scattering [17, 18, 19]. Of

Local structure correlations in cyclohexane

3

Figure 1. The structure of cyclohexane in phase II (left) and phase I (right). Only
deuterium atoms are visible in phase I.

fundamental interest is its thermally-induced solid-solid phase transition at 186 K. Below
this temperature it exists as an ordered crystalline phase (C 2/c, hereafter referred to as
‘phase II’); whereas between 186 and 280 K it is a plastic solid, in which the molecules
are rotationally disordered about the lattice points of a FCC cell (Fm3m, ‘phase I’).
The structures of these phases are shown in Figure 1. The packing arrangement in both
phases has been previously identified through single-crystal X-ray diffraction, where
single crystals of the plastic phase were obtained by growth near the transition point,
using a zone melting technique [20]. The same study showed that phase I can also
been obtained as a plastic crystal glass at 77 K when quenched. Raman scattering,
molecular dynamics (MD) simulations and NMR experiments have all been performed
with the aim of identifying the precise nature of the disorder both in phase I and in the
liquid above 280 K [21, 22, 23, 24]. This was also the intention of a series of neutron
total scattering studies which predominantly focussed on the plastic and liquid phases
[17, 18, 19]. However, owing to instrument limitations at the time, data were only
collected to a Qmax = 16 Å−1 . Modern total scattering instruments are now capable
of collecting data to much higher resolution, ca. 50 Å−1 , which mitigates the effects of
Fourier truncation and consequently makes it easier to discern real peaks from Fourier
ripples in a real-space distribution of interatomic distances. By collecting data to higher
resolution, we are able to use the data to drive refinement of 3-D atomistic models from
which orientational and spatial correlation functions can be extracted. The focus on
the transformation between phases I and II rather than the melting transition aims to
explore the relationship between ordered and disordered phases.
The total scattering data reported in this manuscript have been modelled using
a Reverse Monte Carlo (RMC) [25] approach, producing atomistic structures that are
consistent with both the instantaneous local environment and the average structure,
as would be seen by traditional Rietveld refinement. Farman et al suggest that RMC
refinement could potentially be used to understand the phase behaviour of cyclohexane
further, although they point out that chemically unrealistic atomic configurations are
frequently generated [19]. Following advances in RMC software over the last couple of

Local structure correlations in cyclohexane

4

decades, this is now readily prevented with judicious use of geometry-based restraints.
We report our analysis of high-resolution neutron total scattering data (Qmax =
−1
45 Å ) for cyclohexane-d12 , over a temperature range spanning phases I and II. From
the resulting RMC-refined models, we are able to extract correlation functions which
reveal translational and rotational relationships between neighbouring pairs of molecules
in both phases.
2. Experimental
2.1. Sample preparation
Cyclohexane-d12 (99.5% D), obtained from CDN isotopes, was frozen with liquid
nitrogen and cold-ground into a homogenous powder at 77 K, in a nitrogen atmosphere.
Details of the cold-grinding apparatus are given elsewhere [26].
2.2. Neutron total scattering
The cyclohexane sample was packed into a thin-walled vanadium can and mounted on
a CCR device to control the sample temperature. Total scattering data were collected
on the General Materials Diffractometer (GEM) at the ISIS pulsed neutron and muon
source [27] using the time-of-flight (ToF) method at the following temperatures: 13, 75,
126, 176, 206 and 266 K. The measured differential cross-section data were processed
using GUDRUN [28], to correct for background scattering, multiple scattering, Placzek
inelasticity and beam attenuation by the sample container, giving the normalised total
scattering functions F (Q) (Qmax = 45 Å−1 ) and the corresponding pair distribution
functions D(r). For reference, a thorough comparison of commonly used total scattering
formalisms is given by Keen [29].
The Bragg contribution to the total scattering patterns was analysed separately
using conventional average structure refinement as implemented in GSAS [30, 31].
Rietveld refinement of phase II used the atomic coordinates of the cyclohexane structure
deposited in the Cambridge Structural Database with the Refcode ‘CYCHEX’ as an
initial starting model [20, 32]. Refinement was carried out against data collected
on all detector banks with exception of the 2θ = 5–12 ◦ bank which contained very
few Bragg peaks over the accessible range of d -spacing and so was excluded. The
fit and data corresponding to the 2θ = 50–74 ◦ bank were used to generate the files
required for the Bragg profile component in RMC refinement. Rietveld refinement of
phase I utilised a Frenkel model, where the cyclohexane molecule was modelled over 24
orientations, effectively rotating about its centre of mass. Kahn et al found this model
gave a marginally better fit to X-ray single crystal data than a completely isotropically
disordered model [20]. The refinement was carried out against data collected on the
2θ = 50–74 ◦ detector bank only, which was then used to generate the files for RMC
refinement. Rietveld fits to the data at 13, 176 and 266 K are shown in Figure 2.

Local structure correlations in cyclohexane

Figure 2. Rietveld fits to the phase II data at 13 and 176 K and phase I at 266 K

5

Local structure correlations in cyclohexane

6

2.3. Starting models for Reverse Monte Carlo refinement
Starting models for the RMC refinement at each temperature point were obtained
via MD simulations using the DISCOVER software package implemented in Accelrys
Materials Studio. The cvff forcefield was used with an NPT ensemble [33]. Simulations
were carried out for 20 ps at intervals of 0.5 fs using a Berendsen thermostat and a
Parrinello barostat [34, 35].
A 6 × 6 × 6 supercell was created for each temperature point, consisting of 15552
atoms. The phase II models were obtained by using the Rietveld-refined 13 K crystal
structure as a starting set of coordinates and then performing MD simulations on these at
each experimentally measured temperature. The dimensions of the resulting supercells
were then manually adjusted to those of the relevant, experimentally observed, crystal
structure supercell before undergoing RMC refinement. Construction of the starting
models for phase I was a little more elaborate: molecules were manually placed on
the FCC lattice points of a cell with P 1 symmetry and dimensions corresponding to
the plastic crystal at 206 K. The molecules were arbitrarily orientated in positions that
appeared visually to be sterically favourable. The geometry was coarsely optimised
using DMol3 [36] (final ∆E = 4 × 10−5 Ha) and then MD simulations on a 6 × 6 × 6
supercell were performed. The purpose of the geometry optimisation was to relieve
instabilities in the initial cycles of the MD simulation, which were observed if the
geometry was not optimised. The resulting supercell was then manually adjusted to
have the experimentally observed cell dimensions prior to RMC refinement.
2.4. Reverse Monte Carlo refinement
The program RMCProfile [37] was used to simultaneously fit calculated F (Q), D(r) and
Bragg peak intensities to the experimentally observed patterns by randomly moving
atoms in the supercell. Moves were accepted based on minimisation of the function
χ2RMC =

X

χ2m

(1)

m

where χ2m corresponds to each data set being refined. The individual χ2 functions being
minimised were:
χ2QF (Q) =

X

−2
[QFcalc (Qj ) − QFexp (Qj )]2 σQF
(Q)

(2)

j

χ2D(r) =

X
−2
[Dcalc (rj ) − Dexp (rj )]2 σD(r)

(3)

j

χ2profile

X
exp
−2
calc
=
[Iprofile
(tj ) − Iprofile
(tj )]2 σprofile
j

(4)

Local structure correlations in cyclohexane

7

χ2BS =

1 X
Dl {1 − exp[−α(r − r0 )]}2
kB T l

(5)

χ2BB =

1 X
Kl (cos θ − cos θ0 )2
kB T l

(6)

where σ is a weighting parameter, defined for each separate set of data and Iprofile (t)
corresponds to the Bragg peaks, fitted as a function of neutron flight time. The χ2BS
and χ2BB functions are used for geometric restraints (discussed further below), where D
is the energy required to break a bond, α specifies the curvature of the potential energy
function, r0 is the specified bond length, θ0 is the specified bond angle and K is the
bond angle energy term. All moves that decreased the value of χ2 were automatically
accepted and those that increased χ2 were accepted within the probability limit
P = exp(−∆χ2 /2)

(7)

to avoid becoming trapped in local minima. Refinements of the datasets were carried out
until no further improvements in the value of χ2 were seen, requiring ca. 100 accepted
moves per atom.
In order to generate chemically reasonable atomic configurations, forcefield-based
distance and angle restraints were imposed on the molecular geometry as otherwise
RMCProfile produced erroneous atomic connectivity. Given the rigidity of the
cyclohexane molecule, the intramolecular bond distances and angles should not change
significantly over the temperature range investigated here and so application of these
restraints was quite reasonable. The values used for the bond distances (r0 in (5)) and
angles (θ0 in (6)) were set to those observed in the crystal structure at 13 K. Dl , α and
Kl were set to the default values in the MM3 database. Closest approach restraints were
also employed, preventing D–D, C–D and C–C atom pairs from moving within 1.4, 0.9
and 1.3 Å of each other respectively. These distances were intentionally set below the
realistic closest approach distances seen experimentally (1.7, 1.1 and 1.5 Å) to try and
reduce the level of structural bias introduced into the model as much as possible.
For each phase II dataset, RMCProfile used the scale factor determined in the
corresponding GSAS refinement to fit the Bragg peak intensities, and this was held fixed
for the duration of the run. RMC refinement of the phase I data was more problematic
owing to the difficulty in obtaining a reliable scale factor from the Rietveld refinement, as
it was strongly correlated with the atomic isotropic thermal parameters. Thus the overall
scale factor for the Bragg intensities was also optimised during the RMC refinement.
2.5. Other programs used
Atomic configurations were visualised using CrystalMaker R 8.6 [38] and Mercury 3.0
[39]. Structural figures were created using Atomeye [40] and Pymol [41]. 3-D correlation

Local structure correlations in cyclohexane

8

function data were visualised using Paraview [42]. Cambridge Structural Database
searches were carried out using CONQUEST with database updates up to May 2012
[32].
3. Results
3.1. Initial agreement with data
Prior to RMC refinement, D(r), F (Q) and Bragg profile patterns were calculated from
the starting models and compared with the experimental data. The calculated and
experimental D(r) data at 13, 176 and 266 K are shown in Figure 3. Across all the
temperatures, the MD simulations result in structures that are too strongly correlated
at ca. r < 5 Å, and at 13 K, this excessive correlation extends over the entire range
of real space being explored. This is likely a consequence of the MD simulations
preserving ‘ideal’ bond lengths — an indication that the bond stretching and bending
force constants are too high. However an additional contribution to the peak width in
the experimental data at low r also arises from the treatment of the total scattering
data itself, as Fourier transformation of the F (Q) data over a finite Q range introduces
r-dependent peak broadening.
At 176 K there is markedly better agreement between the MD model and
experimental data above 5 Å, but at 266 K the agreement with respect to peak positions
is rather poor, particularly between 2–5 Å — the region corresponding to nearest
neighbour interactions.
3.2. RMCProfile refinement
The final RMCProfile fits to the D(r), F (Q) and Bragg profile data are shown in Figure
4 for the data at 13, 176 and 266 K. Plots of the final fits to the data at all temperature
points investigated can be found in the Supplementary Information.
Figure 4 shows that the fits to all phase II data are generally very good. The
D(r) plots at r ≤ 5 Å change very little as a function of temperature since the major
contribution to this region of the pattern is from intramolecular contacts, which are not
expected to vary significantly. The intermolecular contacts — the shortest of these being
between deuterium atoms — only start to contribute to the D(r) above ca. 1.8 Å. A
very small degree of peak broadening is present in the low-r region, reflecting the effect
of thermal energy on the magnitude of bond stretching. Conversely, the region above
ca. 5 Å exhibits significant peak broadening when temperature is raised, representing
increased deviation of the instantaneous molecular positions from those of the average
positions. This can be solely ascribed to intermolecular contacts given that the longest
intramolecular distance is ca. 5 Å between the equatorial deuterium atoms on opposite
sides of the cyclohexane ring.
We make a brief comment here regarding the use of the D(r) normalisation in RMC
refinement. Preliminary refinements with the same data and constraints, not reported

Local structure correlations in cyclohexane

9

Figure 3. Initial level of agreement between the experimental D(r) data and the
simulated MD models at 13, 176 and 266 K.

here, were performed with the G(r) normalisation instead. It was found that although
satisfactory fits were obtained for all data, when these fits were recalculated with D(r)
it was apparent that the phase I atomic configurations did not adequately reflect the
experimental D(r) at large r (> 10 Å). This had the effect that phase I models with
some remnant artificial orientational periodicity could still yield good fits to the data.
Returning to the fits in Figure 4, the difference between phase I and phase II most
obviously manifests itself in the Bragg profile data – there are only three significant
Bragg peaks sat on a large background of modulated diffuse scattering, which is
consistent with the onset of rotational disorder in the structure. This point is also
clearly evident in the very diffuse peaks in the D(r) above 5 Å and the disappearance of
peaks in the F (Q). Below 5 Å, the D(r) data are similar to phase II as the connectivity
of the molecule remains unchanged.
The positions of the broad features in the D(r), corresponding to intermolecular
correlations, in the 266 K data are comparable with those reported by Farman at 263 K
(5.9, 10.9, 16.2 and 21.6 Å in our data c.f. 6.0, 11.1, 16.3 and 21.5 Å in Farman’s data)
[18]. It was noted by Farman that the first purely intermolecular peak at 6.0 Å is at
lower r than might be expected as the 8.6836 Å FCC cell edge means that the shortest

Local structure correlations in cyclohexane

10

Figure 4. RMC fits to the D(r) (upper left), F (Q) (upper right) and Bragg profile
(lower left) data at 13, 176 and 266 K. The F (Q) data are shown to Qmax = 20 Å−1
to show the low-Q region more clearly. Plots showing the full Q range can be found in
the S.I. The Bragg profile data at 266 K have been scaled up by a factor of 20 to be
visually comparable with the other data

contact between molecular centroids should be ca. 6.14 Å. In our data, the apex of this
very diffuse peak, which ranges between 4.72 and 7.50 Å actually appears at an even
shorter distance of 5.92 Å. This all points toward an increased need for neighbouring
molecules to interact in a correlated manner whereby molecular orientations are coupled
to nearest-neighbour separation distances.
Aside from peaks in the D(r) that can be attributed to intramolecular contacts,
there are additional peaks at longer r (> 5 Å) common to both phases that only differ
in position by a maximum of ca. 0.4 Å. It is known from the earlier neutron total
scattering experiments [19] that the structure of the plastic phase is dependent on the
thermal history of the sample and so this suggests that even though the phase I structure
may appear rotationally disordered, there are strong local correlations present similar
to those seen in phase II.
3.3. Distribution of atomic positions
In order to gain a clear picture of the atomic site distribution across all temperatures,
10 RMC refinements were carried out at each temperature point, and the resulting

Local structure correlations in cyclohexane

11

Figure 5. Comparison of the instantaneous distribution of carbon atoms with the
average crystal structures as viewed along the c-axis at 13 (left), 176 (centre) and 266 K
(right). Thermal ellipsoids in the lower row are displayed at the 99% level. Deuterium
atoms are omitted for clarity. The two phases are not shown to scale with respect to
each other and so cell constants have been included. The origin of the unit cell in the
266 K crystal structure (lower right) has been shifted to aid visual comparison with
the corresponding instantaneous structure.

configurations combined. This allows improved estimation of uncertainties in derived
parameters such as correlation functions. Figure 5 shows the distribution of carbon
atom positions in the unit cell as a function of temperature, compared with the thermal
ellipsoids of the average crystal structure plotted at the 99% probability level. In the
interest of improved statistical significance all subsequent analysis reported here has
been carried out on this ensemble of 10 RMC configurations for each temperature.
In phase II, the distribution of carbon atoms closely resembles the anisotropic
displacement parameters in the Rietveld-refined crystal structure, reproducing the
effects of increasing temperature on atomic position. In phase I, the distribution of
atoms about each lattice point is approximately spherical although the fit to the Bragg
profile data is not as good as that of phase II — the intensity of one peak is underfitted and another over-fitted. We ascribe this to the probable challenge presented to
the RMC process by the model itself. The combination of close molecular packing and
minimum distance constraints may make it difficult to rotate a molecule, as it necessarily
requires other neighbouring molecules to rotate in a cooperative manner. Thus, the final
molecular orientations are more likely the result of the MD simulations instead. Evidence
for this is presented in the Discussion. However, the RMC process greatly improves upon
the separation distances between molecules, as shown by the initially poor agreement
between the calculated and experimental D(r)’s (Figure 3) and the excellent agreement
obtained when fitted (Figure 4). Whilst the refined distribution of carbon atoms mostly

Local structure correlations in cyclohexane

12

conforms to the FCC symmetry restrictions, there are numerous carbon atoms that are
not located within one of the four ‘main sites’ of atomic distribution, shown in Figure
5. These correspond to a few molecules in each of the datasets that have moved away
from the FCC sites during the RMC refinement. These spatial deviations may not be
structurally unrealistic given that the position of the first intermolecular peak in the
D(r) appears at a shorter distance than the smallest intermolecular separation in the
average structure.
4. Discussion
4.1. Correlated motion
In phase I each molecule should not be able to tumble independently of its nearest
neighbours, simply because there is insufficient space to do so [18]. In order for a
molecule to tumble, the closest molecules must spatially accommodate it, but this
necessarily has implications for successive shells of nearest neighbours. An advantage
of fitting an atomistic model to the data presents itself here — namely features such as
the spatial distribution of molecules and their orientations can be extracted.
An initial assessment of intermolecular D. . . D contacts shows that the vast majority
of molecules do not move unfavourably close to one another, avoiding the occurrence of
contacts below 1.7 Å; the closest approach distance for intermolecular hydrogen atoms
identified by Wood et al [44] for small organic molecules up to pressures of 10 GPa. A
small number of molecules approach each other at distances as low as 1.4 Å — the lowest
limit permitted by the RMC refinement. Figure 6 shows a radial distribution function of
the contacts as a function of temperature, clearly showing that these unrealistic supershort distances are the exception rather than the rule, where the ‘real’ minimum distance
actually appears to be closer to ca. 1.9 Å instead. Since the majority of molecules obey
the 1.7 Å limit, this immediately shows pairwise correlated motion exists to some extent.
In order to obtain a quantitative understanding of the orientational correlations
between pairs of molecules, we proceeded to analyse the RMC configurations purely
in terms of the orientation of each cyclohexane ring and the location of its centre of
mass. For convenience, we represent the orientations as vectors S oriented normal
to the mean plane of the cyclohexane ring, noting that all subsequent calculations
are invariant with respect to inversion. Figure 7 shows representative sections of the
atomic configurations at 13, 176 and 266 K with the vectors represented by doubleended red arrows to reflect this inversion invariance. Orientational correlations between
cyclohexane molecules can then be quantified by the correlation function χ = 2|S·S0 |−1.
Here S and S0 represent the individual molecular orientations for any given pair of
neighbouring molecules. The value of χ is equal to 1 where the molecules are parallel
and χ = −1 when they are perpendicular to one another. Given the likelihood that the
molecular orientations are strongly coupled to separation distance, the relative spatial
positions of each molecular pair were also considered through definition of a centroid–

Local structure correlations in cyclohexane

13

Figure 6.
Partial radial distribution function for intermolecular D. . .D contacts,
colour coded by temperature. The tick marks on the x-axis indicate the centre of bins
with widths of 0.5 Å. The inset plot shows a magnified region of the histogram between
1.3 and 1.8 Å.

Figure 7. Representative sections of the RMC atomic configurations at 13, 176 and
266 K. The arrows represent the axis perpendicular to the mean plane of the molecules.
Deuterium atoms are omitted for clarity.

centroid vector, r, forming the dot products |S·r| and |S0 ·r|. Figure 8 shows the four
extreme orientational and translational relationships that can exist between two of the
molecules and the corresponding values of χ, |S·r| and |S0 ·r| and |r| in each scenario.
To investigate the extent of correlation between molecular orientations and their
separation distance, the dependence of χ on |S·r|, |S0 ·r| and |r| was calculated at 13,
176 and 266 K, and represented using isosurfaces, plotted in Figure 9. The red and blue
surfaces in the Figure correspond to positive and negative values of χ, respectively; i.e.
to molecular pairs that tend towards parallel (red) or perpendicular (blue) orientations.
It is important to emphasise that the surface colours do not mean that the molecules
adopt only the orientations shown in Figure 8 but rather any orientation between 45
and 0◦ , or 45 and 90◦ with respect to each other. The value of χ is calculated in

Local structure correlations in cyclohexane

14

Figure 8. The four molecular pair arrangements that result in the most extreme
values of χ, |S·r| and |S0 ·r|. Scenarios 3 and 4 are equivalent to each other.

both directions along the molecular separation vector and so the surfaces are inherently
symmetrical about the diagonal between the |S·r| and |S0 ·r| axes.
For phase II, shown in Figures 9a and 9b, only a red isosurface exists since all the
molecules are aligned with their normals approximately parallel to the c-axis and so
χ ranges between 0 and 1. Each molecular pair is only able to possess a geometrical
relationship tending towards scenarios 1 or 2 in Figure 8, and not 3 or 4. The isosurface
is restricted to well-defined regions of the 3-D histogram, as would be expected for
an ordered structure. At 13 K, the surface at shortest |r| lies between 4.8 and 5.6 Å
(maximum at 5.2 Å) and is split over two separate regions with respect to |S·r| and
|S0 ·r|; if |S·r| or |S0 ·r| tends to 1 then the other tends toward 0.65. These regions
correspond to four neighbouring molecules — two above and two below a reference
molecule with respect to the ab plane, shown in Figure 10a.
Moving to higher values of |r|, the next region of the isosurface then falls between
5.5 – 6.2 Å (maximum at 5.9 Å), which can be attributed to the other two molecules
above and below the the central reference molecule, displayed in Figure 10b. Figures
9c and 9d show the remaining nearest neighbours that surround the reference molecule
in the ab plane — two at a slightly shorter distance than the other four, which are
represented in Figure 9a by the isosurface region 6.0 > |r| > 7 Å. When the temperature

Local structure correlations in cyclohexane

15

Figure 9. Isosurfaces showing the correlation function, χ for (a) 13 K, (b) 176 K and
(c) 266 K as a function of |r|, |S·r| and |S0 ·r| along the horizontal, diagonal and vertical
axes, respectively. d shows c in projection along |r| when viewed along the directions
indicated by the black arrows. The red surfaces represent values of χ between 0 and 1
and blue surfaces represent values between 0 and −1. The numbers on the surfaces in
c and d correspond to the molecular arrangements in Figure 8.

is raised to 176 K (Figure 9b), the surface is still restricted to the same reasonably
well-defined regions but the volume it encloses increases, reflecting the development of
thermal disorder in the structure but the retention of the same basic structure and
correlations.
In phase I, (Figures 9c and 9d) the molecules exhibit a far wider range of
orientations, and so there is a blue isosurface, representing χ values between −1 and
0, in addition to the red. At each extreme end of the blue surface, if |S·r| = 1 then
|S0 ·r| = 0, and vice versa. The corresponding orientations are depicted in Figure 8
by the equivalent scenarios, 3 and 4. The edges of the blue isosurface have a low |r|
value of 5.2 Å, whereas at intermediate values of |S·r| and |S0 ·r| (ca. 0.3 – 0.7), the
isosurface does not fall below 5.7 Å except for a small protrusion in the centre that
reaches 5.4 Å. This shows that when converting between scenarios 3 and 4 the molecules
must move further apart in order to spatially accommodate the rotation. That this
‘conversion’ section covers a relatively small region of the 3-D histogram suggests that
fewer molecules prefer to adopt the orientation where both molecules make an angle
of ca. 45◦ with the centroid-centroid vector. This may represent something akin to an
orientational transition state between the presumably sterically favoured edge-to-face

Local structure correlations in cyclohexane

16

Figure 10. Nearest neighbours to a central reference molecule in phase II. Panels
a to d show neighbouring molecules at increasing values of |r| respectively. The
corresponding regions of the isosurface from Figure 9a are shown at the bottom of
each panel.

molecular arrangements, typified by scenarios 3 and 4. The overall |r| range that the
blue isosurface covers (ca. 5.2 – 7.3 Å) corresponds to pairwise correlations between
molecules in the corner of the unit cell and at the face centre.
The red isosurface in Figures 9c and 9d is less evenly distributed, where only a
small proportion of molecules align with their neighbour and also with their centroidcentroid vector — numbered ‘1’ in the Figure. Significantly more molecules prefer to be
anywhere between being perpendicular to the centroid-centroid vector, numbered ‘2’, or
making an angle of ca. 45 ◦ with it. The smaller region of the red surface reaches low-|r|
values of 4.8 Å, which is significantly shorter than the corner-to-face distance seen in
the average structure (cf. 6.1 Å), demonstrating that in order for two molecules to move
this close together they must adopt a geometric arrangement resembling scenario 1 in
Figure 8. This distorted geometry bears similarity to the molecular pair arrangement in
phase II with the shortest separation distance (5.241 Å at 176 K), represented by Figure
10a.
The larger of the red regions in Figures 9c and 9d lies between |r| = 5.8 and 7.4 Å
— a much shorter distance than the cubic cell dimension of 8.6836 Å. This region is
most easily considered in two parts — the first at shorter |r| corresponding to molecules
that are approximately located on their average positions in the corner and face centre

Local structure correlations in cyclohexane

17

Figure 11. Red isosurface at 176 K (top row) viewed along three different directions.
The corresponding orientations of the isosurface at 266 K are shown along the bottom
row. The blue isosurface at 266 K has been removed for clarity.

of the unit cell. The second part, at longer |r| can be attributed to molecules that
have deviated from their average positions where the face centre molecules move further
away from the cell origin. When this far apart, the molecules experience reduced steric
hindrance from each other and so are able to adopt a geometry more closely resembling
scenario 2 in Figure 8. Similarly to the smaller red region in Figures 9c and 9d, the
distortion from the average structure results in local environments that are reminiscent
of the average molecular packing seen in phase II, where the molecules are 6.451 Å
(Figure 10c) and 6.516 Å (Figure 10d) apart within the ab plane.
A visual comparison of the red isosurfaces at 176 and 266 K shows that they enclose
a broadly similar region of the 3-D histogram (Figure 11). This is consistent with the
observations, discussed above, that instantaneous structural distortions in phase I result
in local geometry that is more like the average structure of phase II than I. Although it
is harder to identify local features in the phase II models that suggest transformation
into phase I is developing within the structure (other than increased thermal motion), it
is much easier to see how phase I might transform into II. The main difference between
the regions of red isosurface in the two phases is their relative sizes, however the area
of phase I is necessarily reduced owing to a significant quantity of molecules being able
to adopt the perpendicular geometries as a result of the rotational disorder.
4.2. Molecular orientation distribution
The unit cell vectors of phases I and II are related by the transformation




 
a
−0.5
0.5 −1
a
 

 
=
0  b 
 b 
 −0.5 −0.5
c
−0.5
0.5
1
c
II

I

(8)

Local structure correlations in cyclohexane

18

(see Figure 5 in [20]). The transition involves alignment of each molecular three-fold
axis with the monoclinic c-axis (parallel to the [1̄12] direction in the cubic phase). The
distance between molecular centroids changes such that the density in the (001) plane
decreases but these layers approach one another more closely in the [001] direction.
We have examined the distribution of molecular orientations in both phases, plotted in
Figure 12, where the monoclinic cell axes have been transformed to the cubic axis system
and had m3m symmetry applied to the orientational distribution to aid comparison
with phase I. Additionally shown in Figure 12 are the orientational distributions for the
results of the MD simulations, i.e. the starting atomic coordinates for RMC refinement.
The imposition of cubic symmetry generates symmetry equivalent peaks for both data
and noise and so it is important not to place too much significance on fine details in the
plots.
In phase II the molecular orientations align preferentially along the h112i directions,
with respect to the cubic axes, at 13 K and as temperature is raised to 176 K, although
the distribution of orientations increases, the preferred orientations are still along
h112i. This set of directions corresponds to the c-axis in the monoclinic cell setting,
showing that the molecules are in a favourable orientation to transform. The plots
for phase I are shown on a different scale to phase II as otherwise they appear to
show a random distribution of molecular orientations, potentially masking any subtle
structural features. However, rescaling the data also enhances the level of noise and
so we tentatively interpret the plots as showing that the molecular orientations are
not spherically distributed, but instead preferentially align along the h110i directions.
However further work needs to be carried out to unambiguously establish whether the
preferential alignment with the h110i directions in phase I is a real feature or not.
4.3. Molecular dynamics-informed refinements
Of particular note in Figure 12 is that across the whole temperature range there is very
little difference between the distribution of molecular orientations in the MD and RMC
models. In phase II, there is not a strong need for the RMC refinement to alter the
molecular orientations significantly from those defined by the MD simulations. They
are evidently in good agreement with the data to begin with as the refined orientations
show little change, yet the fits to the D(r), F (Q) and Bragg profile data (Figure 4) are
excellent.
In phase I, although the overall agreement between the RMC-refined models and
the data is still very good, a couple of peak intensities in the Bragg profile are overand under-fitted. The suggestion was put forward earlier in this manuscript that the
disordered cyclohexane models might be challenging for RMC refinement as all molecules
would need to be moved cooperatively. Indeed, this can be demonstrated more clearly
when starting from an initially ordered model where the molecules have been placed
arbitrarily on the face centres of the unit cell but are all oriented in the same direction.
Figure 13 shows the RMC fits and the atomic site and molecular orientation distributions

Local structure correlations in cyclohexane

19

Figure 12.
Molecular orientation distributions plotted against cubic axes, the
directions of which are shown in the upper-left plot. The left and right halves of
each distribution correspond to the post-MD, and post-RMC orientations respectively.
Light colours represent the directions perpendicular to which the mean cyclohexane
planes are oriented. The bar on the lower-left shows the scale on which the data are
plotted and the phase is given in parentheses.

for such a model, having been refined for the same period of time as the other phase I
structures reported here. The atomic distribution shows that the final model does not
meet the FCC symmetry requirements and is accompanied by poor fits to the data. In
particular, the additional erroneous peaks in the Bragg profile fit show a lowering of
the average symmetry. A representative overall χ2 value (1) taken from one of the 10
refined models is 25.10 — over twice the value obtained when starting from the MD
coordinates (12.16), suggesting that the model is either jammed in a local minimum or
the refinement is very slow to converge. It may be the case that a satisfactory model
could be obtained if the refinement were allowed to continue for a greater period of time
but this becomes impractical when a reasonable structure can be reached much faster
when the MD simulations are utilised.
This highlights the usefulness of combining RMC with other techniques — MD in
this case — for arriving at a structure that is consistent with the experimental total
scattering data. Other examples in the literature have also demonstrated that RMC
refinements for ‘problematic systems’ arrive at more sensible structures when aided by
complementary information from other techniques [45, 46]. Cyclohexane is arguably
another challenging example as the correlated motion has to be dealt with as well
as preservation of the relatively complex molecular geometry (in the context of other
RMC-refined systems). Here, the role of the MD is to deal with the orientations of the
molecules, and the RMC to broaden this distribution. The more significant outcome
of the RMC refinement is that the intermolecular distances are successfully refined to
show excellent agreement with the experimental data, whereas the separation distances

Local structure correlations in cyclohexane

20

Figure 13.
RMC fits to the D(r) (a), F (Q) (b) and Bragg profile data (c) at
266 K when using an ordered starting model. Panels d and e show the atomic site and
molecular orientation distributions, respectively.

predicted by the MD are relatively poor (Figure 3), especially in phase I.
5. Conclusion
Neutron total scattering data have been collected to a much higher Q max (45 Å−1 )
than previously reported experiments, reducing the effects of Fourier truncation. The
crystalline and plastic phases of cyclohexane have been modelled using RMCProfile
and MD simulations, forming one of the most challenging systems to have been
attempted with the RMC method in terms of the molecular geometry and complexity
of intermolecular steric interactions. From the resulting atomic configurations, 3D correlation functions have been extracted for both phases that confirm molecular
orientation is coupled to spatial distribution. Similar local packing is observed in both
phases, and features from the average structure of phase II are seen to exist locally in
instantaneously distorted regions of phase I.
Plots of molecular orientation distributions have shown that the molecular
arrangements are largely defined by the MD simulations and that the distributions
of orientations are then broadened by the RMC refinements. The main contribution

Local structure correlations in cyclohexane

21

of the RMC process to the resulting atomic configurations is to refine the molecular
separation distances such that they show excellent agreement with the experimental
data across all the investigated temperature points.
6. Acknowledgements
We thank the EPSRC for funding to NPF and SP and to ALG (grant code:
EP/G004528/2), the ERC for funding to NPF and ALG (grant code: 279705), and
the STFC for provision of neutron beamtime.
7.

